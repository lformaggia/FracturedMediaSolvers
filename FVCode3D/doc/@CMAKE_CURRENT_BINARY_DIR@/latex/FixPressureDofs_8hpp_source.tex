\hypertarget{FixPressureDofs_8hpp_source}{}\section{Fix\+Pressure\+Dofs.\+hpp}
\label{FixPressureDofs_8hpp_source}\index{/home/corinne/eni\+Reservoir\+G\+I\+T\+H\+U\+B/eni\+Reservoir/\+F\+V\+Code3\+D/src/\+F\+V\+Code3\+D/assembler/\+Fix\+Pressure\+Dofs.\+hpp@{/home/corinne/eni\+Reservoir\+G\+I\+T\+H\+U\+B/eni\+Reservoir/\+F\+V\+Code3\+D/src/\+F\+V\+Code3\+D/assembler/\+Fix\+Pressure\+Dofs.\+hpp}}

\begin{DoxyCode}
00001 
00006 \textcolor{preprocessor}{#ifndef FIXPRESSUREDOFS\_HPP\_}
00007 \textcolor{preprocessor}{#define FIXPRESSUREDOFS\_HPP\_}
00008 
00009 \textcolor{preprocessor}{#include <\hyperlink{TypeDefinition_8hpp}{FVCode3D/core/TypeDefinition.hpp}>}
00010 
\hypertarget{FixPressureDofs_8hpp_source.tex_l00011}{}\hyperlink{namespaceFVCode3D}{00011} \textcolor{keyword}{namespace }\hyperlink{namespaceFVCode3D}{FVCode3D}
00012 \{
00013 
00015 
00021 \textcolor{keyword}{template} <\textcolor{keyword}{typename} ProblemType>
\hypertarget{FixPressureDofs_8hpp_source.tex_l00022}{}\hyperlink{classFVCode3D_1_1FixPressureDofs}{00022} \textcolor{keyword}{class }\hyperlink{classFVCode3D_1_1FixPressureDofs}{FixPressureDofs}
00023 \{
00024 \textcolor{keyword}{public}:
00025 
00027     \hyperlink{classFVCode3D_1_1FixPressureDofs_a04fe8d95e2ef14366032a712a5015fdb}{FixPressureDofs}() = \textcolor{keyword}{delete};
00028 
00030 
\hypertarget{FixPressureDofs_8hpp_source.tex_l00033}{}\hyperlink{classFVCode3D_1_1FixPressureDofs_a2718e4b7ee481b3fac51c39dc900e036}{00033}     \hyperlink{classFVCode3D_1_1FixPressureDofs_a2718e4b7ee481b3fac51c39dc900e036}{FixPressureDofs}(ProblemType * problem):
00034         \hyperlink{classFVCode3D_1_1FixPressureDofs_ab62654a9bac382fc13e5e3da2a77532b}{M\_problem}(problem) \{\}
00035 
00037 
\hypertarget{FixPressureDofs_8hpp_source.tex_l00040}{}\hyperlink{classFVCode3D_1_1FixPressureDofs_a45678898ff37d7a189233bda0d4d6773}{00040}     ProblemType & \hyperlink{classFVCode3D_1_1FixPressureDofs_a45678898ff37d7a189233bda0d4d6773}{getProblem}()
00041         \{ \textcolor{keywordflow}{return} *\hyperlink{classFVCode3D_1_1FixPressureDofs_ab62654a9bac382fc13e5e3da2a77532b}{M\_problem}; \}
00042 
00044 
00047     \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1FixPressureDofs_a3393776b99ad339672ba99cfc5c200e2}{apply}(\textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a40c1f5588a248569d80aa5f867080e83}{Real} pressure);
00048 
00050     \hyperlink{classFVCode3D_1_1FixPressureDofs_af39545b363f6eb33c5cbffc2fe1d98c9}{~FixPressureDofs}() = \textcolor{keywordflow}{default};
00051 
00052 \textcolor{keyword}{private}:
00053 
\hypertarget{FixPressureDofs_8hpp_source.tex_l00055}{}\hyperlink{classFVCode3D_1_1FixPressureDofs_ab62654a9bac382fc13e5e3da2a77532b}{00055}     ProblemType * \hyperlink{classFVCode3D_1_1FixPressureDofs_ab62654a9bac382fc13e5e3da2a77532b}{M\_problem};
00056 
00057 \}; \textcolor{comment}{// class FixPressureDofs}
00058 
00059 \textcolor{keyword}{template} <\textcolor{keyword}{typename} ProblemType>
\hypertarget{FixPressureDofs_8hpp_source.tex_l00060}{}\hyperlink{classFVCode3D_1_1FixPressureDofs_a3393776b99ad339672ba99cfc5c200e2}{00060} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1FixPressureDofs_a3393776b99ad339672ba99cfc5c200e2}{FixPressureDofs<ProblemType>::apply}(\textcolor{keyword}{const} 
      \hyperlink{namespaceFVCode3D_a40c1f5588a248569d80aa5f867080e83}{Real} pressure)
00061 \{
00062     \hyperlink{namespaceFVCode3D_ac1032289d96638cf0ad6c52ef639095f}{SpMat} & A = \hyperlink{classFVCode3D_1_1FixPressureDofs_ab62654a9bac382fc13e5e3da2a77532b}{M\_problem}->getA();
00063     \hyperlink{namespaceFVCode3D_a16ccf345652402bccd1a5d2e6782526c}{Vector} & b = \hyperlink{classFVCode3D_1_1FixPressureDofs_ab62654a9bac382fc13e5e3da2a77532b}{M\_problem}->getb();
00064 
00065     \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} dofTotal = A.outerSize();
00066     \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} dofFractures = \hyperlink{classFVCode3D_1_1FixPressureDofs_ab62654a9bac382fc13e5e3da2a77532b}{M\_problem}->getMesh().getFractureFacetsIdsVector().size();
00067     \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} dofPorousMatrix = dofTotal - dofFractures;
00068 
00069     \textcolor{comment}{// Clear the fractures rows}
00070     A.bottomRows( dofFractures ) *= 0.;
00071 
00072     \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a40c1f5588a248569d80aa5f867080e83}{Real} weight = A.diagonal().sum() / dofPorousMatrix;
00073 
00074     b.tail( dofFractures ).setConstant( weight * pressure );
00075 
00076     \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} index = dofPorousMatrix; index < dofTotal; ++index )
00077         A.coeffRef( index, index ) = weight;
00078 
00079     A.prune(0.);
00080 \}
00081 
00082 \} \textcolor{comment}{// namespace FVCode3D}
00083 \textcolor{preprocessor}{#endif }\textcolor{comment}{/* FIXPRESSUREDOFS\_HPP\_ */}\textcolor{preprocessor}{}
\end{DoxyCode}
