\hypertarget{Mesh3D_8cpp_source}{}\section{Mesh3\+D.\+cpp}
\label{Mesh3D_8cpp_source}\index{/home/corinne/eni\+Reservoir\+G\+I\+T\+H\+U\+B/eni\+Reservoir/\+F\+V\+Code3\+D/src/\+F\+V\+Code3\+D/mesh/\+Mesh3\+D.\+cpp@{/home/corinne/eni\+Reservoir\+G\+I\+T\+H\+U\+B/eni\+Reservoir/\+F\+V\+Code3\+D/src/\+F\+V\+Code3\+D/mesh/\+Mesh3\+D.\+cpp}}

\begin{DoxyCode}
00001 
00006 \textcolor{preprocessor}{#include <\hyperlink{Mesh3D_8hpp}{FVCode3D/mesh/Mesh3D.hpp}>}
00007 \textcolor{preprocessor}{#include <\hyperlink{Operations_8hpp}{FVCode3D/geometry/Operations.hpp}>}
00008 \textcolor{preprocessor}{#include <\hyperlink{BoundingBox_8hpp}{FVCode3D/geometry/BoundingBox.hpp}>}
00009 \textcolor{preprocessor}{#include <\hyperlink{CoordinateSystem_8hpp}{FVCode3D/geometry/CoordinateSystem.hpp}>}
00010 
00011 \textcolor{preprocessor}{#include <utility>}
00012 \textcolor{preprocessor}{#include <fstream>}
00013 \textcolor{preprocessor}{#include <algorithm>}
00014 \textcolor{preprocessor}{#include <cmath>}
00015 \textcolor{preprocessor}{#include <vector>}
00016 \textcolor{preprocessor}{#include <array>}
00017 \textcolor{preprocessor}{#include <queue>}
00018 
00019 \textcolor{comment}{//#define FVCODE3D\_DEBUG\_CELLS}
\hypertarget{Mesh3D_8cpp_source.tex_l00020}{}\hyperlink{Mesh3D_8cpp_a552a4f8df42d50060ac684d3eda1bb0c}{00020} \textcolor{preprocessor}{#define FVCODE3D\_CELL\_VOLUME\_BY\_GAUSS}
00021 
00022 \textcolor{keyword}{namespace }\hyperlink{namespaceFVCode3D}{FVCode3D}
00023 \{
00024 
00025 \textcolor{comment}{// --------------------   Class Mesh3D::Facet3D   --------------------}
00026 
00027 \textcolor{comment}{// ==================================================}
00028 \textcolor{comment}{// Constructors & Destructor}
00029 \textcolor{comment}{// ==================================================}
\hypertarget{Mesh3D_8cpp_source.tex_l00030}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6a7aee209946492b9b0d31e04e33a290}{00030} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6a7aee209946492b9b0d31e04e33a290}{Mesh3D::Facet3D::Facet3D}() :
00031         M\_mesh(0), M\_area(0.), M\_borderId(0), M\_zone(0) \{\}
00032 
\hypertarget{Mesh3D_8cpp_source.tex_l00033}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a0eff032c65d0fad89835a77c683b60ce}{00033} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6a7aee209946492b9b0d31e04e33a290}{Mesh3D::Facet3D::Facet3D}(\textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D}{Facet3D} & facet) :
00034         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}(facet.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a95ad0d4c24621fe8fbbf2d251f19d13d}{getMesh}()), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}(facet.
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_aca13a319eb625d203f605634a6131657}{getVerticesVector}()),
00035         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a17706f1909c2479234a70c5e8bc440dd}{M\_separatedCells}(facet.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_aa3daf4c15034afd5f92d977fc82f415b}{getSeparatedCells}()),
00036         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ad727210646d148f7af81755fb086310c}{M\_representedFractureIds}(facet.
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae66912e2e920a79192fb19fd297fcf9a}{getRepresentedFractureIds}()),
00037         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6f7dafb218d207354ad6454f4825728f}{M\_centroid}(facet.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a71c26001376d591ad2612b288f13ebde}{getCentroid}()),
00038         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal}(facet.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_acd7cac3cfc7754ca6217f7813f12be49}{getUnsignedNormal}()), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area}(facet.
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a5911a7cad6e25a6a20e6f1615ed13733}{getArea}()),
00039         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ad113bfcfe986c011457bfde02c6016a8}{M\_borderId}(facet.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a341bd5d2f05a9ec1aece9ce5da9ef095}{getBorderId}()), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_afdbaf5ef57c9020b773f4fcf1e6131bb}{M\_zone}(facet.
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6d6da4899793cff2013f95422c6b85fa}{getZoneCode}()) \{\}
00040 
\hypertarget{Mesh3D_8cpp_source.tex_l00041}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_aff7e597dcc26f5733b0e954a2e73afab}{00041} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6a7aee209946492b9b0d31e04e33a290}{Mesh3D::Facet3D::Facet3D}(\hyperlink{classFVCode3D_1_1Mesh3D}{Mesh3D} * \textcolor{keyword}{const} mesh, \textcolor{keyword}{const} std::vector<UInt> & 
      vertices, \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} zone, \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} borderId) :
00042                 \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}(mesh), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}(vertices), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ad113bfcfe986c011457bfde02c6016a8}{M\_borderId}(borderId), 
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_afdbaf5ef57c9020b773f4fcf1e6131bb}{M\_zone}(zone)
00043 \{
00044     \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_af4fe5bce97fc48c94fdcf667941c21b8}{computeCentroidAndNormalAndArea}();
00045 \}
00046 
00047 \textcolor{comment}{// ==================================================}
00048 \textcolor{comment}{// Methods}
00049 \textcolor{comment}{// ==================================================}
00050 
\hypertarget{Mesh3D_8cpp_source.tex_l00051}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_af4fe5bce97fc48c94fdcf667941c21b8}{00051} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_af4fe5bce97fc48c94fdcf667941c21b8}{Mesh3D::Facet3D::computeCentroidAndNormalAndArea}()
00052 \{
00053     assert(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}.size() >= 3);
00054 
00055     \textcolor{keywordflow}{if}(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}.size() > 3)
00056     \{
00057         \hyperlink{classFVCode3D_1_1Point3D}{Point3D} center(0., 0., 0.);
00058 
00059         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \textcolor{keywordtype}{id} : \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds})
00060         \{
00061             center += \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[id];
00062         \}
00063         center /= M\_vertexIds.size();
00064 
00065         \textcolor{keyword}{auto} it1 = M\_vertexIds.begin();
00066         \textcolor{keyword}{auto} it2 = it1;
00067         it2++;
00068 
00069         \hyperlink{namespaceFVCode3D_a40c1f5588a248569d80aa5f867080e83}{Real} area = 0.;
00070         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} = 0.;
00071         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6f7dafb218d207354ad6454f4825728f}{M\_centroid} = \hyperlink{classFVCode3D_1_1Point3D}{Point3D}(0., 0., 0.);
00072         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal} = \hyperlink{classFVCode3D_1_1Point3D}{Point3D}(0., 0., 0.);
00073 
00074         \textcolor{keywordflow}{for}( ; it2 != M\_vertexIds.end(); ++it1, ++it2)
00075         \{
00076             \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[*it1];
00077             \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[*it2];
00078 
00079             area = \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{FVCode3D::triangleArea}(center, B, C);
00080 
00081             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} += area;
00082             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6f7dafb218d207354ad6454f4825728f}{M\_centroid} += ( center + B + C ) / 3. * area;
00083             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal} += \hyperlink{namespaceFVCode3D_afdf87b62988c2271186926eb3a3baedc}{FVCode3D::computeNormal}(center, B, C) * area;
00084         \}
00085 
00086         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[ M\_vertexIds[M\_vertexIds.size
      ()-1] ];
00087         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[ M\_vertexIds[0] ];
00088 
00089         area = \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{FVCode3D::triangleArea}(center, B, C );
00090 
00091         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} += area;
00092         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6f7dafb218d207354ad6454f4825728f}{M\_centroid} += ( center + B + C ) / 3. * area;
00093         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal} += \hyperlink{namespaceFVCode3D_afdf87b62988c2271186926eb3a3baedc}{FVCode3D::computeNormal}(center, B, C) * area;
00094 
00095         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6f7dafb218d207354ad6454f4825728f}{M\_centroid} /= \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area};
00096         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal} /= \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area};
00097         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal}.\hyperlink{classFVCode3D_1_1Point3D_a0d1cd3d114b0985ae2b11cd1c52de673}{normalize}();
00098     \}
00099     \textcolor{keywordflow}{else}
00100     \{
00101         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} A(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[0]]);
00102         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[1]]);
00103         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[2]]);
00104         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal} = \hyperlink{namespaceFVCode3D_afdf87b62988c2271186926eb3a3baedc}{FVCode3D::computeNormal}(A,B,C);
00105 
00106         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} = \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{FVCode3D::triangleArea}(A,B,C);
00107 
00108         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6f7dafb218d207354ad6454f4825728f}{M\_centroid} = ( \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[0]] +
00109                        \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[1]] +
00110                        \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[2]]
00111                      ) / 3.;
00112     \}
00113 \}
00114 
\hypertarget{Mesh3D_8cpp_source.tex_l00115}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ace915c86bf9d191e9df37c1ff77c998e}{00115} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ace915c86bf9d191e9df37c1ff77c998e}{Mesh3D::Facet3D::computeNormal}()
00116 \{
00117     assert(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}.size() >= 3);
00118 
00119     \textcolor{keywordflow}{if}(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}.size() > 3)
00120     \{
00121         \hyperlink{classFVCode3D_1_1Point3D}{Point3D} center(0., 0., 0.);
00122 
00123         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \textcolor{keywordtype}{id} : \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds})
00124         \{
00125             center += \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[id];
00126         \}
00127         center /= M\_vertexIds.size();
00128 
00129         \textcolor{keyword}{auto} it1 = M\_vertexIds.begin();
00130         \textcolor{keyword}{auto} it2 = it1;
00131         it2++;
00132         \hyperlink{namespaceFVCode3D_a40c1f5588a248569d80aa5f867080e83}{Real} area = 0.;
00133         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} = 0.;
00134         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal} = \hyperlink{classFVCode3D_1_1Point3D}{Point3D}(0., 0., 0.);
00135 
00136         \textcolor{keywordflow}{for}( ; it2 != M\_vertexIds.end(); ++it1, ++it2)
00137         \{
00138             \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[*it1];
00139             \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[*it2];
00140 
00141             area = \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{FVCode3D::triangleArea}(center, B, C);
00142 
00143             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} += area;
00144             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal} += \hyperlink{namespaceFVCode3D_afdf87b62988c2271186926eb3a3baedc}{FVCode3D::computeNormal}(center, B, C) * area;
00145         \}
00146 
00147         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[ M\_vertexIds[M\_vertexIds.size
      ()-1] ];
00148         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[ M\_vertexIds[0] ];
00149 
00150         area = \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{FVCode3D::triangleArea}( center, B, C );
00151 
00152         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} += area;
00153         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal} += \hyperlink{namespaceFVCode3D_afdf87b62988c2271186926eb3a3baedc}{FVCode3D::computeNormal}(center, B, C) * area;
00154         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal} /= \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area};
00155         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal}.\hyperlink{classFVCode3D_1_1Point3D_a0d1cd3d114b0985ae2b11cd1c52de673}{normalize}();
00156     \}
00157     \textcolor{keywordflow}{else}
00158     \{
00159         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} A(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[0]]);
00160         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[1]]);
00161         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[2]]);
00162         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ada6d0c218b56473802d91a34f2ecc4cf}{M\_normal} = \hyperlink{namespaceFVCode3D_afdf87b62988c2271186926eb3a3baedc}{FVCode3D::computeNormal}(A,B,C);
00163     \}
00164 
00165     \textcolor{comment}{// --- For planar facet ---}
00166 \textcolor{comment}{//  UInt i = 3;}
00167 \textcolor{comment}{//  const UInt nPoints = getNumberOfVertices();}
00168 \textcolor{comment}{//  const Point3D A(M\_mesh->getNodesVector()[M\_vertexIds[0]]);}
00169 \textcolor{comment}{//  const Point3D B(M\_mesh->getNodesVector()[M\_vertexIds[1]]);}
00170 \textcolor{comment}{//  Point3D C(M\_mesh->getNodesVector()[M\_vertexIds[2]]);}
00171 \textcolor{comment}{//  while( (std::fabs(innerAngleRad(B-A,C-A)) < 1e-6) && (i<nPoints) )}
00172 \textcolor{comment}{//      C = M\_mesh->getNodesVector()[M\_vertexIds[i++]];}
00173 \textcolor{comment}{//}
00174 \textcolor{comment}{//  M\_normal = FVCode3D::computeNormal(A,B,C);}
00175 \}
00176 
\hypertarget{Mesh3D_8cpp_source.tex_l00177}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_add443b097967551ad360f30fc7810f43}{00177} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_add443b097967551ad360f30fc7810f43}{Mesh3D::Facet3D::computeArea}()
00178 \{
00179     assert(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}.size() >= 3);
00180 
00181     \textcolor{keywordflow}{if}(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}.size() > 3)
00182     \{
00183         \hyperlink{classFVCode3D_1_1Point3D}{Point3D} center(0., 0., 0.);
00184 
00185         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \textcolor{keywordtype}{id} : \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds})
00186         \{
00187             center += \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[id];
00188         \}
00189         center /= M\_vertexIds.size();
00190 
00191         \textcolor{keyword}{auto} it1 = M\_vertexIds.begin();
00192         \textcolor{keyword}{auto} it2 = it1;
00193         it2++;
00194         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} = 0.;
00195 
00196         \textcolor{keywordflow}{for}( ; it2 != M\_vertexIds.end(); ++it1, ++it2)
00197         \{
00198             \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[*it1];
00199             \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[*it2];
00200 
00201             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} = \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{FVCode3D::triangleArea}(center, B, C);
00202         \}
00203 
00204         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[ M\_vertexIds[M\_vertexIds.size
      ()-1] ];
00205         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[ M\_vertexIds[0] ];
00206 
00207         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} = \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{FVCode3D::triangleArea}( center, B, C );
00208     \}
00209     \textcolor{keywordflow}{else}
00210     \{
00211         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} A(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[0]]);
00212         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[1]]);
00213         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[2]]);
00214         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} = \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{FVCode3D::triangleArea}(A,B,C);
00215     \}
00216 
00217     \textcolor{comment}{// --- For planar facet, also non-convex ---}
00218 \textcolor{comment}{//    std::vector<Point3D> points;}
00219 \textcolor{comment}{//    CoordinateSystem3D cs;}
00220 \textcolor{comment}{//    Real area(0.);}
00221 \textcolor{comment}{//    const UInt nPoints = M\_vertexIds.size();}
00222 \textcolor{comment}{//}
00223 \textcolor{comment}{//    cs.computeCartesianCoordinateSystem(M\_normal);}
00224 \textcolor{comment}{//    points.reserve(nPoints);}
00225 \textcolor{comment}{//}
00226 \textcolor{comment}{//    for(UInt i=0; i < nPoints; ++i)}
00227 \textcolor{comment}{//        points.emplace\_back( M\_mesh->getNodesVector()[M\_vertexIds[i]].convertInLocalCoordinates(cs,
       Point3D(0.,0.,0.)) );}
00228 \textcolor{comment}{//}
00229 \textcolor{comment}{//    for(UInt i=0; i < (nPoints-1) ; ++i)}
00230 \textcolor{comment}{//        area += points[i].x() * points[i+1].y() - points[i].y() * points[i+1].x();}
00231 \textcolor{comment}{//}
00232 \textcolor{comment}{//    area += points[nPoints-1].x() * points[0].y() - points[nPoints-1].y() * points[0].x();}
00233 \textcolor{comment}{//}
00234 \textcolor{comment}{//    M\_area = std::fabs(area)/2;}
00235 \}
00236 
\hypertarget{Mesh3D_8cpp_source.tex_l00237}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a67899ed8ad959cf2788f011b9e87dc15}{00237} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a67899ed8ad959cf2788f011b9e87dc15}{Mesh3D::Facet3D::computeCentroid}()
00238 \{
00239     assert(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}.size() >= 3);
00240 
00241     \textcolor{keywordflow}{if}(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}.size() > 3)
00242     \{
00243         \hyperlink{classFVCode3D_1_1Point3D}{Point3D} center(0., 0., 0.);
00244 
00245         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \textcolor{keywordtype}{id} : \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds})
00246         \{
00247             center += \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[id];
00248         \}
00249         center /= M\_vertexIds.size();
00250 
00251         \textcolor{keyword}{auto} it1 = M\_vertexIds.begin();
00252         \textcolor{keyword}{auto} it2 = it1;
00253         it2++;
00254         \hyperlink{namespaceFVCode3D_a40c1f5588a248569d80aa5f867080e83}{Real} area = 0.;
00255         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} = 0.;
00256         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6f7dafb218d207354ad6454f4825728f}{M\_centroid} = \hyperlink{classFVCode3D_1_1Point3D}{Point3D}(0., 0., 0.);
00257 
00258         \textcolor{keywordflow}{for}( ; it2 != M\_vertexIds.end(); ++it1, ++it2)
00259         \{
00260             \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[*it1];
00261             \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[*it2];
00262 
00263             area = \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{FVCode3D::triangleArea}(center, B, C);
00264 
00265             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} += area;
00266             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6f7dafb218d207354ad6454f4825728f}{M\_centroid} += ( center + B + C ) / 3. * area;
00267         \}
00268 
00269         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[ M\_vertexIds[M\_vertexIds.size
      ()-1] ];
00270         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[ M\_vertexIds[0] ];
00271 
00272         area = \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{FVCode3D::triangleArea}( center, B, C );
00273 
00274         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area} += area;
00275         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6f7dafb218d207354ad6454f4825728f}{M\_centroid} += ( center + B + C ) / 3. * area;
00276         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6f7dafb218d207354ad6454f4825728f}{M\_centroid} /= \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a464195f44615c5dcba666c6ec3fde430}{M\_area};
00277     \}
00278     \textcolor{keywordflow}{else}
00279     \{
00280         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} A(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[0]]);
00281         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} B(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[1]]);
00282         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} C(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[2]]);
00283         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a6f7dafb218d207354ad6454f4825728f}{M\_centroid} = ( \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[0]] +
00284                        \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[1]] +
00285                        \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[2]]
00286                      ) / 3.;
00287     \}
00288 
00289     \textcolor{comment}{// --- For planar facet, but not non-convex (use computeArea() for planar facet) ---}
00290 \textcolor{comment}{//    UInt N = M\_vertexIds.size();}
00291 \textcolor{comment}{//    Real tmpArea, totArea = 0.;}
00292 \textcolor{comment}{//}
00293 \textcolor{comment}{//    for (UInt j = 1; j < N-1; ++j)}
00294 \textcolor{comment}{//    \{}
00295 \textcolor{comment}{//        tmpArea = triangleArea( M\_mesh->getNodesVector()[M\_vertexIds[0]],}
00296 \textcolor{comment}{//                                M\_mesh->getNodesVector()[M\_vertexIds[j]],}
00297 \textcolor{comment}{//                                M\_mesh->getNodesVector()[M\_vertexIds[j+1]]);}
00298 \textcolor{comment}{//        totArea += tmpArea;}
00299 \textcolor{comment}{//        M\_centroid += tmpArea * (   M\_mesh->getNodesVector()[M\_vertexIds[0]] +}
00300 \textcolor{comment}{//                                        M\_mesh->getNodesVector()[M\_vertexIds[j]] +}
00301 \textcolor{comment}{//                                        M\_mesh->getNodesVector()[M\_vertexIds[j+1]]}
00302 \textcolor{comment}{//                                    ) / 3.;}
00303 \textcolor{comment}{//    \}}
00304 \textcolor{comment}{//}
00305 \textcolor{comment}{//    M\_centroid /= totArea;}
00306 \}
00307 
\hypertarget{Mesh3D_8cpp_source.tex_l00308}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a8ecdf3275bf4bd6ac921f691e3746383}{00308} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a8ecdf3275bf4bd6ac921f691e3746383}{Mesh3D::Facet3D::showMe}(std::ostream  & out)\textcolor{keyword}{ const}
00309 \textcolor{keyword}{}\{
00310     out << \textcolor{stringliteral}{"Type = Facet3D :"};
00311     out << \textcolor{stringliteral}{"M\_mesh = "} << \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh} << std::endl;
00312     out << \textcolor{stringliteral}{"  ->"} << std::endl;
00313     \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} i=0; i<\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}.size(); ++i)
00314     \{
00315         out << \textcolor{stringliteral}{"    M\_idP["}<<i<<\textcolor{stringliteral}{"] = "} << \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ae763d815d2b4406b2f09d0ee5133392c}{M\_vertexIds}[i] << std::endl;
00316     \}
00317     out << \textcolor{stringliteral}{"  -> M\_separatedCells : size = "} << \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a17706f1909c2479234a70c5e8bc440dd}{M\_separatedCells}.size();
00318     out << \textcolor{stringliteral}{"    [ "};
00319     \textcolor{keywordflow}{if}( !\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a17706f1909c2479234a70c5e8bc440dd}{M\_separatedCells}.empty() )
00320         \textcolor{keywordflow}{for}( std::set<UInt>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a17706f1909c2479234a70c5e8bc440dd}{M\_separatedCells}.begin();
00321                 it != \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a17706f1909c2479234a70c5e8bc440dd}{M\_separatedCells}.end(); ++it )
00322             out << *it << \textcolor{stringliteral}{" "};
00323     out << \textcolor{stringliteral}{" ] "} << std::endl;
00324     out << \textcolor{stringliteral}{"  -> M\_representedFractureIds : [ "};
00325     \textcolor{keywordflow}{if}( !\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ad727210646d148f7af81755fb086310c}{M\_representedFractureIds}.empty() )
00326         \textcolor{keywordflow}{for}( std::set<UInt>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ad727210646d148f7af81755fb086310c}{M\_representedFractureIds}.begin();
00327                 it != \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_ad727210646d148f7af81755fb086310c}{M\_representedFractureIds}.end(); ++it )
00328             out << *it << \textcolor{stringliteral}{" "};
00329     out << \textcolor{stringliteral}{" ] "} << std::endl;
00330 \}
00331 
00332 
00333 \textcolor{comment}{// --------------------   Class Mesh3D::Cell3D   --------------------}
00334 
00335 \textcolor{comment}{// ==================================================}
00336 \textcolor{comment}{// Constructors & Destructor}
00337 \textcolor{comment}{// ==================================================}
\hypertarget{Mesh3D_8cpp_source.tex_l00338}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a975daf83e16e8ee91f06e346a6fbb37d}{00338} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a975daf83e16e8ee91f06e346a6fbb37d}{Mesh3D::Cell3D::Cell3D}() :
00339         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_adf8cf45ade4804389de18428aea4969d}{M\_mesh}(0), M\_volume(0.), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_afdbaf5ef57c9020b773f4fcf1e6131bb}{M\_zone}(0) \{\}
00340 
\hypertarget{Mesh3D_8cpp_source.tex_l00341}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_aab1f2e91f0e2c6a4dc366b114802cbff}{00341} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a975daf83e16e8ee91f06e346a6fbb37d}{Mesh3D::Cell3D::Cell3D}(\textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D}{Cell3D} & cell) :
00342         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}(cell.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a0b189bebb77030c320b3d51b873de936}{getMesh}()), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}(cell.
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_add685e1431913c75e0d6186b7290a60e}{getVerticesVector}()),
00343         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1aa6b2a5119a2b94946f9a7dcfcb9478}{M\_facetIds}(cell.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ab39f9e4bf268566da035b41ce6a409be}{getFacetsSet}()), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ab05458f242974547b2657d0806fc3daa}{M\_neighborIds}(cell.
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a87f2464749df5772205e0dd76afe46e6}{getNeighborsSet}()),
00344         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid}(cell.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a47f492dd7173a7ce4364b7137453b878}{getCentroid}()),
00345         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume}(cell.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_add653e825e5557c5f178bbe8e904b26a}{volume}()), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ae984573970908f2c3080d4091a076e7f}{M\_zone}(cell.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a07529d28c440e3c23e612c73e2925a54}{getZoneCode}()) \{\}
00346 
\hypertarget{Mesh3D_8cpp_source.tex_l00347}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ac02c0684ef4259520ed1a312ce402bb5}{00347} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a975daf83e16e8ee91f06e346a6fbb37d}{Mesh3D::Cell3D::Cell3D}( \hyperlink{classFVCode3D_1_1Mesh3D}{Mesh3D} * \textcolor{keyword}{const} mesh, \textcolor{keyword}{const} std::vector<UInt> & facets, \textcolor{keyword}{
      const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} zone ) :
00348         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}(mesh), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1aa6b2a5119a2b94946f9a7dcfcb9478}{M\_facetIds}(facets.\hyperlink{namespacestd_acec9a198880c12f51f02be95a298a48b}{begin}(), facets.\hyperlink{namespacestd_aeb4b319cf9afda99ba1f47d32df15bc9}{end}()), 
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ae984573970908f2c3080d4091a076e7f}{M\_zone}(zone)
00349 \{
00350     \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ae410bd71367b8bb52d9e4b1a53a2bb13}{computeVertexIds}();
00351     \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ae4ba3b75f888448f83672fcef7d24f2c}{computeVolumeAndCentroid}();
00352 \}
00353 
00354 \textcolor{comment}{// ==================================================}
00355 \textcolor{comment}{// Methods}
00356 \textcolor{comment}{// ==================================================}
\hypertarget{Mesh3D_8cpp_source.tex_l00357}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ae410bd71367b8bb52d9e4b1a53a2bb13}{00357} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ae410bd71367b8bb52d9e4b1a53a2bb13}{Mesh3D::Cell3D::computeVertexIds}()
00358 \{
00359     \textcolor{keywordflow}{for}(std::set<UInt>::const\_iterator it=\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1aa6b2a5119a2b94946f9a7dcfcb9478}{M\_facetIds}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1aa6b2a5119a2b94946f9a7dcfcb9478}{M\_facetIds}.end(); ++it)
00360     \{
00361         \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D}{Facet3D} & f = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a76de387da2a552e3e1210d795bc7acf9}{getFacetsMap}().at(*it);
00362         \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} N = f.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a5ae9fec253c58a2e90abbb2593dba60a}{getNumberOfVertices}();
00363         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.reserve(N);
00364         \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} j=0; j<N; ++j)
00365             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.push\_back(f.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_a5496550ad89319ec65f2a8a383ac627b}{getVertexId}(j));
00366     \}
00367 
00368     sort(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.begin(), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.end());
00369     \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.erase( unique( \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.begin(), 
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.end() ), \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.end() );
00370 \}
00371 
\hypertarget{Mesh3D_8cpp_source.tex_l00372}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_aa5980d36b600b69686105050a4918b60}{00372} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_aa5980d36b600b69686105050a4918b60}{Mesh3D::Cell3D::outerNormalToFacet}(\textcolor{keyword}{const} 
      \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} & facetId) \textcolor{keyword}{const} \textcolor{keywordflow}{throw}()
00373 \{
00374     \textcolor{keywordtype}{bool} found(\textcolor{keyword}{false});
00375     \hyperlink{classFVCode3D_1_1Point3D}{Point3D} normal(0., 0., 0.), v\_centr;
00376 
00377     \textcolor{comment}{// control that facetId is a facet of this cell}
00378     \textcolor{keywordflow}{for}( std::set<UInt>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1aa6b2a5119a2b94946f9a7dcfcb9478}{M\_facetIds}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1aa6b2a5119a2b94946f9a7dcfcb9478}{M\_facetIds}.end(); ++it )
00379     \{
00380         \textcolor{keywordflow}{if}( *it == facetId )
00381             found = \textcolor{keyword}{true};
00382     \}
00383 
00384     \textcolor{comment}{// check if the facet exists in this cell}
00385     \textcolor{keywordflow}{if}( !found )
00386     \{
00387         std::stringstream error;
00388         error << \textcolor{stringliteral}{"Error: the facet "} << facetId << \textcolor{stringliteral}{" is not in the cell."};
00389         \textcolor{keywordflow}{throw} std::runtime\_error(error.str());
00390     \}
00391 
00392     \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D}{Facet3D} & facet = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a76de387da2a552e3e1210d795bc7acf9}{getFacetsMap}().at( facetId );
00393 
00394     normal = facet.getUnsignedNormal();
00395 
00396     v\_centr = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid} - facet.getVertex(2);
00397 
00398     \textcolor{keywordflow}{if}( normal * v\_centr > 0 )
00399         \textcolor{keywordflow}{return} -normal;
00400 
00401     \textcolor{keywordflow}{return} normal;
00402 \}
00403 
\hypertarget{Mesh3D_8cpp_source.tex_l00404}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ab398572491821d827c2324b340e05c10}{00404} \textcolor{keywordtype}{bool} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ab398572491821d827c2324b340e05c10}{Mesh3D::Cell3D::hasNeighborsThroughFacet}( \textcolor{keyword}{const} 
      \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} & facetId, \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} & idNeighbor)\textcolor{keyword}{ const}
00405 \textcolor{keyword}{}\{
00406     \textcolor{keywordtype}{bool} found(\textcolor{keyword}{false});
00407 
00408     \textcolor{keywordflow}{for}( std::set<UInt>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ab05458f242974547b2657d0806fc3daa}{M\_neighborIds}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ab05458f242974547b2657d0806fc3daa}{M\_neighborIds}.end(); ++it )
00409     \{
00410         \textcolor{keywordflow}{if}( std::find( \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_ad904ef5e068c89951d77e9364e960bf3}{getCellsMap}().at(*it).getFacetsSet().begin(), 
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_ad904ef5e068c89951d77e9364e960bf3}{getCellsMap}().at(*it).getFacetsSet().end(), facetId )
00411             != \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_ad904ef5e068c89951d77e9364e960bf3}{getCellsMap}().at(*it).getFacetsSet().end() )
00412         \{
00413             idNeighbor = *it;
00414             found = 1;
00415             \textcolor{keywordflow}{break};
00416         \}
00417     \}
00418 
00419     \textcolor{keywordflow}{return} found;
00420 \}
00421 
\hypertarget{Mesh3D_8cpp_source.tex_l00422}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ae4ba3b75f888448f83672fcef7d24f2c}{00422} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_ae4ba3b75f888448f83672fcef7d24f2c}{Mesh3D::Cell3D::computeVolumeAndCentroid}()
00423 \{
00424     assert(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.size() >= 4);
00425 
00426     \textcolor{keywordflow}{if}(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.size() > 4)
00427     \{
00428 \textcolor{preprocessor}{#ifdef FVCODE3D\_CELL\_VOLUME\_BY\_GAUSS}
00429         std::vector<Point3D> nodes;
00430         std::vector< std::vector<UInt> > facets;
00431         std::map<UInt, UInt> globalToLocal;
00432 
00433         \textcolor{comment}{// Count the number of vertices and facets that}
00434         \textcolor{comment}{// define the approximation of the non-planar facets polyhedron}
00435         \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nNodes = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a4877a883d7ae0abfe581809606ce260c}{verticesNumber}();
00436         \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} addedNodes = 0;
00437         \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nFacets = 0;
00438         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \textcolor{keywordtype}{id} : \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1aa6b2a5119a2b94946f9a7dcfcb9478}{M\_facetIds})
00439         \{
00440             \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nodesFacet = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a76de387da2a552e3e1210d795bc7acf9}{getFacetsMap}().at(\textcolor{keywordtype}{id}).getNumberOfVertices
      ();
00441 
00442             \textcolor{keywordflow}{if}( nodesFacet > 3 )
00443             \{
00444                 addedNodes++;
00445                 nFacets += nodesFacet;
00446             \}
00447             \textcolor{keywordflow}{else}
00448             \{
00449                 nFacets++;
00450             \}
00451         \}
00452 
00453         \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nodesFacet, i, j, intNodesCount(0), intFacetsCount(0);
00454         std::set<UInt>::iterator it;
00455 
00456         nodes.resize( nNodes + addedNodes );
00457         facets.resize( nFacets );
00458 
00459         \textcolor{keywordflow}{for}(i=0; i < nNodes; ++i)
00460         \{
00461             nodes[i] = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}[i]];
00462             globalToLocal.insert(std::make\_pair(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}[i], i));
00463         \}
00464 
00465         \textcolor{keyword}{typedef} std::pair< UInt, UInt > edge\_Type;
00466         \textcolor{keyword}{typedef} std::map< edge\_Type, std::array<UInt,2> > map\_Type;
00467 
00468         std::map< edge\_Type, std::array<UInt,2> > edgeToTria;
00469         std::vector< std::array<edge\_Type, 3 > > triaToEdge(nFacets);
00470         std::pair< map\_Type::iterator , bool > itMap;
00471 
00472         \textcolor{keywordflow}{for}(i=0, it=M\_facetIds.begin(); it != M\_facetIds.end(); ++i, ++it)
00473         \{
00474             \textcolor{keyword}{auto}& facet = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a76de387da2a552e3e1210d795bc7acf9}{getFacetsMap}().at(*it);
00475             nodesFacet = facet.getNumberOfVertices();
00476 
00477             \textcolor{keywordflow}{if}( nodesFacet > 3 )
00478             \{
00479                 \hyperlink{classFVCode3D_1_1Point3D}{Point3D} center(0., 0., 0.);
00480 
00481                 \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \textcolor{keywordtype}{id} : facet.getVerticesVector())
00482                 \{
00483                     center += \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[id];
00484                 \}
00485                 center /= nodesFacet;
00486                 nodes[nNodes + intNodesCount] = center;
00487 
00488                 \textcolor{comment}{// loop over the triangles that settle the current facet}
00489                 \textcolor{keywordflow}{for}(j=0; j < nodesFacet; ++j)
00490                 \{
00491                     \textcolor{comment}{// add the j-th triangle}
00492                     facets[intFacetsCount].resize(3);
00493                     facets[intFacetsCount][0] = nNodes + intNodesCount;
00494                     facets[intFacetsCount][1] = globalToLocal[ facet.getVerticesVector()[j%nodesFacet] ];
00495                     facets[intFacetsCount][2] = globalToLocal[ facet.getVerticesVector()[(j+1)%nodesFacet] 
      ];
00496 
00497                     \textcolor{comment}{// fill the edgeToTria map and the triaToEdge vector}
00498                     \textcolor{keywordflow}{for}( \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} e = 0; e < 3; ++e)
00499                     \{
00500                         itMap = edgeToTria.insert( std::make\_pair( std::make\_pair(facets[intFacetsCount][e%
      3],
00501                                 facets[intFacetsCount][(e+1)%3] ), std::array<UInt,2>\{ \{ intFacetsCount, 
      intFacetsCount \} \} ) );
00502 
00503                         \textcolor{keywordflow}{if}( !itMap.second )
00504                             itMap.first->second[1] = intFacetsCount;
00505 
00506                         itMap = edgeToTria.insert( std::make\_pair( std::make\_pair(facets[intFacetsCount][(e
      +1)%3],
00507                                 facets[intFacetsCount][e%3] ), std::array<UInt,2>\{ \{ intFacetsCount, 
      intFacetsCount \} \} ) );
00508 
00509                         \textcolor{keywordflow}{if}( !itMap.second )
00510                             itMap.first->second[1] = intFacetsCount;
00511 
00512                         triaToEdge[intFacetsCount][e] = std::make\_pair( facets[intFacetsCount][e%3] ,
00513                                                                         facets[intFacetsCount][(e+1)%3] );
00514                     \}
00515 
00516                     intFacetsCount++;
00517                 \}
00518 
00519                 intNodesCount++;
00520             \}
00521             \textcolor{keywordflow}{else}
00522             \{
00523                 facets[intFacetsCount].resize(3);
00524                 \textcolor{keywordflow}{for}(j=0; j < 3; ++j)
00525                     facets[intFacetsCount][j] = globalToLocal[ facet.getVerticesVector()[j] ];
00526 
00527                 \textcolor{comment}{// fill the edgeToTria map}
00528                 \textcolor{keywordflow}{for}( \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} e = 0; e < 3; ++e)
00529                 \{
00530                     itMap = edgeToTria.insert( std::make\_pair( std::make\_pair(facets[intFacetsCount][e%3],
00531                             facets[intFacetsCount][(e+1)%3] ), std::array<UInt,2>\{ \{ intFacetsCount, 
      intFacetsCount \} \} ) );
00532 
00533                     \textcolor{keywordflow}{if}( !itMap.second )
00534                         itMap.first->second[1] = intFacetsCount;
00535 
00536                     itMap = edgeToTria.insert( std::make\_pair( std::make\_pair(facets[intFacetsCount][(e+1)%
      3],
00537                             facets[intFacetsCount][e%3] ), std::array<UInt,2>\{ \{ intFacetsCount, 
      intFacetsCount \} \} ) );
00538 
00539                     \textcolor{keywordflow}{if}( !itMap.second )
00540                         itMap.first->second[1] = intFacetsCount;
00541 
00542                     triaToEdge[intFacetsCount][e] = std::make\_pair( facets[intFacetsCount][e%3] ,
00543                                                                     facets[intFacetsCount][(e+1)%3] );
00544                 \}
00545 
00546                 intFacetsCount++;
00547             \}
00548         \}
00549 
00550         std::vector<bool> checked(nFacets,\textcolor{keyword}{false});
00551         std::vector<bool> orientation(nFacets,\textcolor{keyword}{true});
00552         std::queue<UInt> queueTria;
00553         std::vector<Real> sign(nFacets);
00554 
00555         queueTria.push(0);
00556         checked[0] = \textcolor{keyword}{true};
00557         \textcolor{keywordflow}{while}(!queueTria.empty())
00558         \{
00559             \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} idTria = queueTria.front();
00560             queueTria.pop();
00561 
00562             \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} i = 0; i < 3; ++i)
00563             \{
00564                 \textcolor{keyword}{const} edge\_Type edge(facets[idTria][i%3] ,
00565                                      facets[idTria][(i+1)%3] );
00566                 \textcolor{keyword}{const} \textcolor{keyword}{auto}& trias = *(edgeToTria.find(edge));
00567                 \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} idOther = ( idTria == trias.second[0] ) ? trias.second[1] : trias.second[0];
00568 
00569                 \textcolor{keyword}{const} \textcolor{keywordtype}{bool} found = std::find( \hyperlink{namespacestd_acec9a198880c12f51f02be95a298a48b}{std::begin}( triaToEdge[idOther] ) , 
      \hyperlink{namespacestd_aeb4b319cf9afda99ba1f47d32df15bc9}{std::end}( triaToEdge[idOther] ) , edge )
00570                                    != \hyperlink{namespacestd_aeb4b319cf9afda99ba1f47d32df15bc9}{std::end}( triaToEdge[idOther] );
00571 
00572                 orientation[idOther] = orientation[idTria] ^ found;
00573 
00574                 \textcolor{keywordflow}{if}(!checked[idOther])
00575                 \{
00576                     queueTria.push(idOther);
00577                     checked[idOther] = \textcolor{keyword}{true};
00578                 \}
00579             \}
00580 
00581             sign[idTria] = ( 2. * \textcolor{keyword}{static\_cast<}\hyperlink{namespaceFVCode3D_a40c1f5588a248569d80aa5f867080e83}{Real}\textcolor{keyword}{>}(orientation[idTria]) - 1. );
00582         \}
00583 
00584 \textcolor{preprocessor}{#ifdef FVCODE3D\_DEBUG\_CELLS}
00585         std::cout<<std::endl<<std::endl<<\textcolor{stringliteral}{"--- NEW ELEMENT ---"}<<std::endl;
00586 
00587         std::cout<<\textcolor{stringliteral}{"NODI INIZIALI con centroidi facce"}<<std::endl;
00588         std::cout.precision(16);
00589         \textcolor{keywordflow}{for}(i=0; i < nodes.size(); ++i)
00590         \{
00591             std::cout<<i<<\textcolor{stringliteral}{": "}<<nodes[i]<<std::endl;
00592         \}
00593 
00594         i=0;
00595         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}& facet : facets)
00596         \{
00597             std::cout<<\textcolor{stringliteral}{"FACCIA "}<<i++<<std::endl;
00598             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}& \textcolor{keywordtype}{id} : facet)
00599             \{
00600                 std::cout<<\textcolor{stringliteral}{"\(\backslash\)t"}<<id;
00601             \}
00602             std::cout<<std::endl;
00603         \}
00604 \textcolor{comment}{//        for(i=0, it=M\_facetIds.begin(); it != M\_facetIds.end(); ++i, ++it)}
00605 \textcolor{comment}{//        \{}
00606 \textcolor{comment}{//            auto& facet = M\_mesh->getFacetsMap().at(*it);}
00607 \textcolor{comment}{//            std::cout<<"FACCIA "<<i<<std::endl;}
00608 \textcolor{comment}{//            for(auto id : facet.getVerticesVector())}
00609 \textcolor{comment}{//            \{}
00610 \textcolor{comment}{//                std::cout<<"\(\backslash\)t"<<globalToLocal[id];}
00611 \textcolor{comment}{//            \}}
00612 \textcolor{comment}{//            std::cout<<std::endl;}
00613 \textcolor{comment}{//        \}}
00614 \textcolor{preprocessor}{#endif // FVCODE3D\_DEBUG\_CELLS}
00615 
00616         \hyperlink{classFVCode3D_1_1BoundingBox}{BoundingBox} BB(nodes);
00617         BB.\hyperlink{classFVCode3D_1_1BoundingBox_a20d4281f025fd6a4ee51ec8cbc47874c}{scaleNodesToUnit}(nodes);
00618 
00619 \textcolor{preprocessor}{#ifdef FVCODE3D\_DEBUG\_CELLS}
00620         std::cout<<\textcolor{stringliteral}{"xMin: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a8406e82493459d67f7c6e01c41401b01}{xMin}()<<std::endl;
00621         std::cout<<\textcolor{stringliteral}{"yMin: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a8d241063de29672a73e478ccef500fcd}{yMin}()<<std::endl;
00622         std::cout<<\textcolor{stringliteral}{"zMin: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a332192fde3727b7de1c9864e98659ac1}{zMin}()<<std::endl;
00623         std::cout<<\textcolor{stringliteral}{"xMax: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a0ba4fbfa989d212c7f9df6b5ee440ef2}{xMax}()<<std::endl;
00624         std::cout<<\textcolor{stringliteral}{"yMax: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_abcec6a60efb3a0bd3333bba6cb8c5eb4}{yMax}()<<std::endl;
00625         std::cout<<\textcolor{stringliteral}{"zMax: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a9b1fee0fe7324865743f4029dd06e1a3}{zMax}()<<std::endl;
00626         std::cout<<\textcolor{stringliteral}{"mx: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a2afb68488fb7361595825089c271fa23}{mx}()<<std::endl;
00627         std::cout<<\textcolor{stringliteral}{"my: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a286722e958824c1798a85a55325d9fe5}{my}()<<std::endl;
00628         std::cout<<\textcolor{stringliteral}{"mz: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_aaff1f6eb030c4f8a15dd22c79a28bf0c}{mz}()<<std::endl;
00629         std::cout<<\textcolor{stringliteral}{"qx: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a6b6ca1d8e9bc92d6f5eebdb329577530}{qx}()<<std::endl;
00630         std::cout<<\textcolor{stringliteral}{"qy: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_ae429d21fd242df838ed0343757eba744}{qy}()<<std::endl;
00631         std::cout<<\textcolor{stringliteral}{"qz: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_accc6026eaa331a6075805479b60141f4}{qz}()<<std::endl;
00632 
00633         std::cout<<\textcolor{stringliteral}{"NODI SCALATI con centroidi facce"}<<std::endl;
00634         \textcolor{keywordflow}{for}(i=0; i < nodes.size(); ++i)
00635         \{
00636             std::cout<<i<<\textcolor{stringliteral}{": "}<<nodes[i]<<std::endl;
00637         \}
00638 \textcolor{preprocessor}{#endif // FVCODE3D\_DEBUG\_CELLS}
00639 
00640         \textcolor{comment}{// For each (triangular) facet we build a tetrahedron by adding a}
00641         \textcolor{comment}{// fourth point at the center of the cell}
00642         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume} = 0.;
00643         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid} = \hyperlink{classFVCode3D_1_1Point3D}{Point3D}(0., 0., 0.);
00644         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} facet = \hyperlink{namespacestd_acec9a198880c12f51f02be95a298a48b}{std::begin}( facets ); facet != \hyperlink{namespacestd_aeb4b319cf9afda99ba1f47d32df15bc9}{std::end}( facets ); ++facet)
00645         \{
00646             std::vector<Point3D> p(3);
00647             p[0] = nodes[(*facet)[0]];
00648             p[1] = nodes[(*facet)[1]];
00649             p[2] = nodes[(*facet)[2]];
00650 
00651             \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} index = \hyperlink{namespaceFVCode3D_a705717c0673e24ca607c7a65054de4f7}{std::distance}( \hyperlink{namespacestd_acec9a198880c12f51f02be95a298a48b}{std::begin}( facets ) , facet );
00652             \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} triangleNormal = sign[index] * 
      \hyperlink{namespaceFVCode3D_afdf87b62988c2271186926eb3a3baedc}{FVCode3D::computeNormal}( p[0], p[1], p[2] );
00653             \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a40c1f5588a248569d80aa5f867080e83}{Real} \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{triangleArea} = \hyperlink{namespaceFVCode3D_a38b320ef9683fae74a67a2a5a921f0d9}{FVCode3D::triangleArea}( p[0], p
      [1], p[2] );
00654             \textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} \hyperlink{namespaceFVCode3D_a5b8d6a9c921fcd809d263ef9c484b1ad}{triangleCentroid} = 
      \hyperlink{namespaceFVCode3D_a5b8d6a9c921fcd809d263ef9c484b1ad}{FVCode3D::triangleCentroid}( p[0], p[1], p[2] );
00655             \hyperlink{classFVCode3D_1_1Point3D}{Point3D} localCentroid(0., 0., 0.);
00656 
00657             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume} += triangleArea * \hyperlink{namespaceFVCode3D_ad07be7f9ed843ca65d02d0303dae6cb4}{dotProduct}( triangleCentroid , triangleNormal );
00658 
00659             localCentroid.\hyperlink{classFVCode3D_1_1Point3D_ae015d6aa31f8b304f69696bdcbd4da19}{x}() += ( (p[0] + p[1]).x() * (p[0] + p[1]).x() * triangleNormal.
      \hyperlink{classFVCode3D_1_1Point3D_ae015d6aa31f8b304f69696bdcbd4da19}{x}() +
00660                                    (p[1] + p[2]).x() * (p[1] + p[2]).x() * triangleNormal.
      \hyperlink{classFVCode3D_1_1Point3D_ae015d6aa31f8b304f69696bdcbd4da19}{x}() +
00661                                    (p[2] + p[0]).x() * (p[2] + p[0]).x() * triangleNormal.
      \hyperlink{classFVCode3D_1_1Point3D_ae015d6aa31f8b304f69696bdcbd4da19}{x}() );
00662 
00663             localCentroid.\hyperlink{classFVCode3D_1_1Point3D_a950abcabbf3bb32fc2daf64c28d77416}{y}() += ( (p[0] + p[1]).y() * (p[0] + p[1]).y() * triangleNormal.
      \hyperlink{classFVCode3D_1_1Point3D_a950abcabbf3bb32fc2daf64c28d77416}{y}() +
00664                                    (p[1] + p[2]).y() * (p[1] + p[2]).y() * triangleNormal.
      \hyperlink{classFVCode3D_1_1Point3D_a950abcabbf3bb32fc2daf64c28d77416}{y}() +
00665                                    (p[2] + p[0]).y() * (p[2] + p[0]).y() * triangleNormal.
      \hyperlink{classFVCode3D_1_1Point3D_a950abcabbf3bb32fc2daf64c28d77416}{y}() );
00666 
00667             localCentroid.\hyperlink{classFVCode3D_1_1Point3D_a865109e2006cc1de3681ab601081f5aa}{z}() += ( (p[0] + p[1]).z() * (p[0] + p[1]).z() * triangleNormal.
      \hyperlink{classFVCode3D_1_1Point3D_a865109e2006cc1de3681ab601081f5aa}{z}() +
00668                                    (p[1] + p[2]).z() * (p[1] + p[2]).z() * triangleNormal.
      \hyperlink{classFVCode3D_1_1Point3D_a865109e2006cc1de3681ab601081f5aa}{z}() +
00669                                    (p[2] + p[0]).z() * (p[2] + p[0]).z() * triangleNormal.
      \hyperlink{classFVCode3D_1_1Point3D_a865109e2006cc1de3681ab601081f5aa}{z}() );
00670             localCentroid *= triangleArea / 12.;
00671 
00672             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid} += localCentroid;
00673         \}
00674         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume} /= 3.;
00675         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid} /= 2. * \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume};
00676 
00677         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume} /= (BB.\hyperlink{classFVCode3D_1_1BoundingBox_a2afb68488fb7361595825089c271fa23}{mx}() * BB.\hyperlink{classFVCode3D_1_1BoundingBox_a286722e958824c1798a85a55325d9fe5}{my}() * BB.\hyperlink{classFVCode3D_1_1BoundingBox_aaff1f6eb030c4f8a15dd22c79a28bf0c}{mz}());
00678         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume} = std::fabs( \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume} );
00679         BB.\hyperlink{classFVCode3D_1_1BoundingBox_ae45df69b786a19e4413691e1c64059d0}{scaleNodesToPhysical}(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid});
00680 
00681 \textcolor{preprocessor}{#ifdef FVCODE3D\_DEBUG\_CELLS}
00682         std::cout<<\textcolor{stringliteral}{"Volume: "}<<\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume}<<std::endl;
00683         std::cout<<\textcolor{stringliteral}{"Centroid: "}<<\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid}<<std::endl;
00684 \textcolor{preprocessor}{#endif // FVCODE3D\_DEBUG\_CELLS}
00685 \textcolor{comment}{//        Real gaussVolume = M\_volume;}
00686 \textcolor{comment}{//        Point3D gaussCentroid = M\_centroid;}
00687 \textcolor{comment}{//        \{}
00688 \textcolor{preprocessor}{#else // FVCODE3D\_CELL\_VOLUME\_BY\_GAUSS}
00689         std::vector<Point3D> nodes;
00690         std::vector< std::vector<UInt> > facets;
00691         std::map<UInt, UInt> globalToLocal;
00692 
00693         \textcolor{comment}{// Count the number of vertices and facets that}
00694         \textcolor{comment}{// define the approximation of the non-planar facets polyhedron}
00695         \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nNodes = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a4877a883d7ae0abfe581809606ce260c}{verticesNumber}();
00696         \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} addedNodes = 0;
00697         \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nFacets = 0;
00698         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \textcolor{keywordtype}{id} : M\_facetIds)
00699         \{
00700             \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nodesFacet = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a76de387da2a552e3e1210d795bc7acf9}{getFacetsMap}().at(\textcolor{keywordtype}{id}).getNumberOfVertices
      ();
00701 
00702             \textcolor{keywordflow}{if}( nodesFacet > 3 )
00703             \{
00704                 addedNodes++;
00705                 nFacets += nodesFacet;
00706             \}
00707             \textcolor{keywordflow}{else}
00708             \{
00709                 nFacets++;
00710             \}
00711         \}
00712 
00713         \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nodesFacet, i, j, intNodesCount(0), intFacetsCount(0);
00714         std::set<UInt>::iterator it;
00715 
00716         nodes.resize( nNodes + addedNodes );
00717         facets.resize( nFacets );
00718 
00719         \hyperlink{classFVCode3D_1_1Point3D}{Point3D} cellCenter(0., 0., 0.);
00720 
00721         \textcolor{keywordflow}{for}(i=0; i < nNodes; ++i)
00722         \{
00723             nodes[i] = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}[i]];
00724             globalToLocal.insert(std::make\_pair(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}[i], i));
00725             cellCenter += nodes[i];
00726         \}
00727         cellCenter /= nNodes;
00728 
00729         \textcolor{keywordflow}{for}(i=0, it=M\_facetIds.begin(); it != M\_facetIds.end(); ++i, ++it)
00730         \{
00731             \textcolor{keyword}{auto}& facet = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a76de387da2a552e3e1210d795bc7acf9}{getFacetsMap}().at(*it);
00732             nodesFacet = facet.getNumberOfVertices();
00733 
00734             \textcolor{keywordflow}{if}( nodesFacet > 3 )
00735             \{
00736                 \hyperlink{classFVCode3D_1_1Point3D}{Point3D} center(0., 0., 0.);
00737 
00738                 \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} \textcolor{keywordtype}{id} : facet.getVerticesVector())
00739                 \{
00740                     center += \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[id];
00741                 \}
00742                 center /= nodesFacet;
00743                 nodes[nNodes + intNodesCount] = center;
00744 
00745                 \textcolor{comment}{// loop over the triangles (except the last one) that settle the current facet}
00746                 \textcolor{keywordflow}{for}(j=0; j < nodesFacet - 1; ++j)
00747                 \{
00748                     \textcolor{comment}{// add the j-th triangle}
00749                     facets[intFacetsCount].resize(3);
00750                     facets[intFacetsCount][0] = nNodes + intNodesCount;
00751                     facets[intFacetsCount][1] = globalToLocal[ facet.getVerticesVector()[j] ];
00752                     facets[intFacetsCount][2] = globalToLocal[ facet.getVerticesVector()[j+1] ];
00753                     intFacetsCount++;
00754                 \}
00755                 \textcolor{comment}{// the last triangle that settles the current facet}
00756                 facets[intFacetsCount].resize(3);
00757                 facets[intFacetsCount][0] = nNodes + intNodesCount;
00758                 facets[intFacetsCount][1] = globalToLocal[ facet.getVerticesVector()[nodesFacet - 1] ];
00759                 facets[intFacetsCount][2] = globalToLocal[ facet.getVerticesVector()[0] ];
00760                 intFacetsCount++;
00761 
00762                 intNodesCount++;
00763             \}
00764             \textcolor{keywordflow}{else}
00765             \{
00766                 facets[intFacetsCount].resize(3);
00767                 \textcolor{keywordflow}{for}(j=0; j < 3; ++j)
00768                     facets[intFacetsCount][j] = globalToLocal[ facet.getVerticesVector()[j] ];
00769                 intFacetsCount++;
00770             \}
00771         \}
00772 
00773 \textcolor{preprocessor}{#ifdef FVCODE3D\_DEBUG\_CELLS}
00774         std::cout<<std::endl<<std::endl<<\textcolor{stringliteral}{"--- NEW ELEMENT ---"}<<std::endl;
00775 
00776         std::cout<<\textcolor{stringliteral}{"NODI INIZIALI con centroidi facce"}<<std::endl;
00777         std::cout.precision(16);
00778         \textcolor{keywordflow}{for}(i=0; i < nodes.size(); ++i)
00779         \{
00780             std::cout<<i<<\textcolor{stringliteral}{": "}<<nodes[i]<<std::endl;
00781         \}
00782 
00783         i=0;
00784         \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}& facet : facets)
00785         \{
00786             std::cout<<\textcolor{stringliteral}{"FACCIA "}<<i++<<std::endl;
00787             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto}& \textcolor{keywordtype}{id} : facet)
00788             \{
00789                 std::cout<<\textcolor{stringliteral}{"\(\backslash\)t"}<<id;
00790             \}
00791             std::cout<<std::endl;
00792         \}
00793 \textcolor{comment}{//        for(i=0, it=M\_facetIds.begin(); it != M\_facetIds.end(); ++i, ++it)}
00794 \textcolor{comment}{//        \{}
00795 \textcolor{comment}{//            auto& facet = M\_mesh->getFacetsMap().at(*it);}
00796 \textcolor{comment}{//            std::cout<<"FACCIA "<<i<<std::endl;}
00797 \textcolor{comment}{//            for(auto id : facet.getVerticesVector())}
00798 \textcolor{comment}{//            \{}
00799 \textcolor{comment}{//                std::cout<<"\(\backslash\)t"<<globalToLocal[id];}
00800 \textcolor{comment}{//            \}}
00801 \textcolor{comment}{//            std::cout<<std::endl;}
00802 \textcolor{comment}{//        \}}
00803 \textcolor{preprocessor}{#endif // FVCODE3D\_DEBUG\_CELLS}
00804 
00805         \hyperlink{classFVCode3D_1_1BoundingBox}{BoundingBox} BB(nodes);
00806         BB.\hyperlink{classFVCode3D_1_1BoundingBox_a20d4281f025fd6a4ee51ec8cbc47874c}{scaleNodesToUnit}(nodes);
00807         BB.\hyperlink{classFVCode3D_1_1BoundingBox_a20d4281f025fd6a4ee51ec8cbc47874c}{scaleNodesToUnit}(cellCenter);
00808 
00809 \textcolor{preprocessor}{#ifdef FVCODE3D\_DEBUG\_CELLS}
00810         std::cout<<\textcolor{stringliteral}{"xMin: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a8406e82493459d67f7c6e01c41401b01}{xMin}()<<std::endl;
00811         std::cout<<\textcolor{stringliteral}{"yMin: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a8d241063de29672a73e478ccef500fcd}{yMin}()<<std::endl;
00812         std::cout<<\textcolor{stringliteral}{"zMin: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a332192fde3727b7de1c9864e98659ac1}{zMin}()<<std::endl;
00813         std::cout<<\textcolor{stringliteral}{"xMax: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a0ba4fbfa989d212c7f9df6b5ee440ef2}{xMax}()<<std::endl;
00814         std::cout<<\textcolor{stringliteral}{"yMax: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_abcec6a60efb3a0bd3333bba6cb8c5eb4}{yMax}()<<std::endl;
00815         std::cout<<\textcolor{stringliteral}{"zMax: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a9b1fee0fe7324865743f4029dd06e1a3}{zMax}()<<std::endl;
00816         std::cout<<\textcolor{stringliteral}{"mx: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a2afb68488fb7361595825089c271fa23}{mx}()<<std::endl;
00817         std::cout<<\textcolor{stringliteral}{"my: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a286722e958824c1798a85a55325d9fe5}{my}()<<std::endl;
00818         std::cout<<\textcolor{stringliteral}{"mz: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_aaff1f6eb030c4f8a15dd22c79a28bf0c}{mz}()<<std::endl;
00819         std::cout<<\textcolor{stringliteral}{"qx: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_a6b6ca1d8e9bc92d6f5eebdb329577530}{qx}()<<std::endl;
00820         std::cout<<\textcolor{stringliteral}{"qy: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_ae429d21fd242df838ed0343757eba744}{qy}()<<std::endl;
00821         std::cout<<\textcolor{stringliteral}{"qz: "}<<BB.\hyperlink{classFVCode3D_1_1BoundingBox_accc6026eaa331a6075805479b60141f4}{qz}()<<std::endl;
00822 
00823         std::cout<<\textcolor{stringliteral}{"NODI SCALATI con centroidi facce"}<<std::endl;
00824         \textcolor{keywordflow}{for}(i=0; i < nodes.size(); ++i)
00825         \{
00826             std::cout<<i<<\textcolor{stringliteral}{": "}<<nodes[i]<<std::endl;
00827         \}
00828 \textcolor{preprocessor}{#endif // FVCODE3D\_DEBUG\_CELLS}
00829 
00830         \textcolor{comment}{// For each (triangular) facet we build a tetrahedron by adding a}
00831         \textcolor{comment}{// fourth point at the center of the cell}
00832         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume} = 0;
00833         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid} = \hyperlink{classFVCode3D_1_1Point3D}{Point3D}(0., 0., 0.);
00834         \textcolor{keywordflow}{for} (std::vector< std::vector<UInt> >::const\_iterator facetIt = facets.begin();
00835             facetIt != facets.end(); ++facetIt)
00836         \{
00837             std::vector<Point3D> tetrahedronNodes(4);
00838             tetrahedronNodes[0] = nodes[(*facetIt)[0]];
00839             tetrahedronNodes[1] = nodes[(*facetIt)[1]];
00840             tetrahedronNodes[2] = nodes[(*facetIt)[2]];
00841             tetrahedronNodes[3] = cellCenter;
00842             \hyperlink{namespaceFVCode3D_a40c1f5588a248569d80aa5f867080e83}{Real} partialVolume = \hyperlink{namespaceFVCode3D_a8a6b07162e2801b628c3bd4057b9f221}{FVCode3D::tetrahedronVolume}(
      tetrahedronNodes);
00843             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume} += partialVolume;
00844             \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid} += partialVolume * ( tetrahedronNodes[0] + tetrahedronNodes[1] + 
      tetrahedronNodes[2] + tetrahedronNodes[3] ) / 4.;
00845         \}
00846         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid} /= \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume};
00847 
00848         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume} /= (BB.\hyperlink{classFVCode3D_1_1BoundingBox_a2afb68488fb7361595825089c271fa23}{mx}() * BB.\hyperlink{classFVCode3D_1_1BoundingBox_a286722e958824c1798a85a55325d9fe5}{my}() * BB.\hyperlink{classFVCode3D_1_1BoundingBox_aaff1f6eb030c4f8a15dd22c79a28bf0c}{mz}());
00849         BB.\hyperlink{classFVCode3D_1_1BoundingBox_ae45df69b786a19e4413691e1c64059d0}{scaleNodesToPhysical}(\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid});
00850 
00851 \textcolor{preprocessor}{#ifdef FVCODE3D\_DEBUG\_CELLS}
00852         std::cout<<\textcolor{stringliteral}{"Volume: "}<<\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume}<<std::endl;
00853         std::cout<<\textcolor{stringliteral}{"Centroid: "}<<\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid}<<std::endl;
00854 \textcolor{preprocessor}{#endif // FVCODE3D\_DEBUG\_CELLS}
00855 \textcolor{comment}{//        std::cout<<"Volume: "<<M\_volume<<std::endl;}
00856 \textcolor{comment}{//        std::cout<<"GaussVolume: "<<gaussVolume<<std::endl;}
00857 \textcolor{comment}{//        std::cout<<"Centroid: "<<M\_centroid<<std::endl;}
00858 \textcolor{comment}{//        std::cout<<"GaussCentroid: "<<gaussCentroid<<std::endl;}
00859 \textcolor{comment}{//}
00860 \textcolor{comment}{//        std::cout<<"Err Volume: "<<(M\_volume - gaussVolume) / M\_volume<<std::endl;}
00861 \textcolor{comment}{//        std::cout<<"Err Centrois: "<<(M\_centroid - gaussCentroid).norm() /
       M\_centroid.norm()<<std::endl<<std::endl;}
00862 \textcolor{comment}{//        M\_volume = gaussVolume;}
00863 \textcolor{comment}{//        M\_centroid = gaussCentroid;}
00864 \textcolor{comment}{//    \}}
00865 \textcolor{preprocessor}{#endif // FVCODE3D\_CELL\_VOLUME\_BY\_GAUSS}
00866     \}
00867     \textcolor{keywordflow}{else}
00868     \{
00869         std::vector<Point3D> nodes(4);
00870         nodes[0] = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}[0]];
00871         nodes[1] = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}[1]];
00872         nodes[2] = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}[2]];
00873         nodes[3] = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh}->\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()[\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}[3]];
00874 
00875         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a7616a6d28fcd8013bc52f4d754569e60}{M\_volume} = \hyperlink{namespaceFVCode3D_a8a6b07162e2801b628c3bd4057b9f221}{FVCode3D::tetrahedronVolume}(nodes);
00876         \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a85077932a074f0903d085f9d33a13e09}{M\_centroid} = ( nodes[0] + nodes[1] + nodes[2] + nodes[3] ) / 4.;
00877     \}
00878 \}
00879 
\hypertarget{Mesh3D_8cpp_source.tex_l00880}{}\hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a215649b0f0eac6a30031f98a38f191e6}{00880} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a215649b0f0eac6a30031f98a38f191e6}{Mesh3D::Cell3D::showMe}(std::ostream & out)\textcolor{keyword}{ const}
00881 \textcolor{keyword}{}\{
00882     out << \textcolor{stringliteral}{"Type = Cell3D :"};
00883     out << \textcolor{stringliteral}{" M\_mesh : "} << \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a5f593479ad61eb1a043b7ec977db39bb}{M\_mesh} << std::endl;
00884     out << \textcolor{stringliteral}{"  -> M\_vertexIds : size = "} << \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.size() << std::endl;
00885     \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1c43369fa1a00208ff3293aad35a70aa}{M\_vertexIds}.end(); ++it )
00886         out << \textcolor{stringliteral}{"    VertexId = "}<< *it << std::endl;
00887     out << \textcolor{stringliteral}{"  -> M\_facetIds : size = "} << \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1aa6b2a5119a2b94946f9a7dcfcb9478}{M\_facetIds}.size() << std::endl;
00888     \textcolor{keywordflow}{for}( std::set<UInt>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1aa6b2a5119a2b94946f9a7dcfcb9478}{M\_facetIds}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Cell3D_a1aa6b2a5119a2b94946f9a7dcfcb9478}{M\_facetIds}.end(); ++it )
00889         out << \textcolor{stringliteral}{"    FacetId = "}<< *it << std::endl;
00890 \}
00891 
00892 
00893 \textcolor{comment}{// --------------------   Class Mesh3D   --------------------}
00894 
00895 \textcolor{comment}{// ==================================================}
00896 \textcolor{comment}{// Constructors & Destructor}
00897 \textcolor{comment}{// ==================================================}
\hypertarget{Mesh3D_8cpp_source.tex_l00898}{}\hyperlink{classFVCode3D_1_1Mesh3D_a761b316925bc26ca886e126e9a397bd5}{00898} \hyperlink{classFVCode3D_1_1Mesh3D_a761b316925bc26ca886e126e9a397bd5}{Mesh3D::Mesh3D}():
00899         \hyperlink{classFVCode3D_1_1Mesh3D_ab197671318545b2b026899d435e79ddd}{M\_fn}(*this) \{\}
00900 
\hypertarget{Mesh3D_8cpp_source.tex_l00901}{}\hyperlink{classFVCode3D_1_1Mesh3D_a1d214ce5c2472a00e102176ff4e08eba}{00901} \hyperlink{classFVCode3D_1_1Mesh3D_a761b316925bc26ca886e126e9a397bd5}{Mesh3D::Mesh3D}(\textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Mesh3D}{Mesh3D} & mesh):
00902         \hyperlink{classFVCode3D_1_1Mesh3D_ab197671318545b2b026899d435e79ddd}{M\_fn}(mesh.\hyperlink{classFVCode3D_1_1Mesh3D_a6ba176804035a210ee1f73348ec04aca}{getFN}()), \hyperlink{classFVCode3D_1_1Mesh3D_a5464981fd097ce785675d91522884739}{M\_nodes}(mesh.\hyperlink{classFVCode3D_1_1Mesh3D_a04162ec60e0fe52674b3ecbb7de1185c}{getNodesVector}()),
00903         \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}(mesh.\hyperlink{classFVCode3D_1_1Mesh3D_a76de387da2a552e3e1210d795bc7acf9}{getFacetsMap}()), \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}(mesh.
      \hyperlink{classFVCode3D_1_1Mesh3D_ad904ef5e068c89951d77e9364e960bf3}{getCellsMap}()) \{\}
00904 
\hypertarget{Mesh3D_8cpp_source.tex_l00905}{}\hyperlink{classFVCode3D_1_1Mesh3D_a164529f402302f3f74235ad91c8bea07}{00905} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_a164529f402302f3f74235ad91c8bea07}{Mesh3D::updateFacetsWithFractures}()
00906 \{
00907     \textcolor{keywordflow}{for}(std::vector<Fracture3D>::iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_ab197671318545b2b026899d435e79ddd}{M\_fn}.\hyperlink{classFVCode3D_1_1FractureNetwork3D_ad9a40fd0d922b50d29d60e8c4d65f496}{getNetwork}().begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_ab197671318545b2b026899d435e79ddd}{M\_fn}.\hyperlink{classFVCode3D_1_1FractureNetwork3D_ad9a40fd0d922b50d29d60e8c4d65f496}{getNetwork}().end(); ++it)
00908         \textcolor{keywordflow}{for}(std::vector<UInt>::iterator jt = it->getFractureFacetsId().begin(); jt != it->
      getFractureFacetsId().end(); ++jt)
00909             \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}[*jt].getRepresentedFractureIds().insert(it->getId());
00910 \}
00911 
\hypertarget{Mesh3D_8cpp_source.tex_l00912}{}\hyperlink{classFVCode3D_1_1Mesh3D_ab1595d6ad6373719cf597c323ed6909b}{00912} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_ab1595d6ad6373719cf597c323ed6909b}{Mesh3D::updateFacetsWithCells}()
00913 \{
00914     \textcolor{keywordflow}{for}(std::map<UInt,Cell3D>::iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.end(); ++it)
00915         \textcolor{keywordflow}{for}(std::set<UInt>::iterator jt = it->second.getFacetsSet().begin(); jt != it->second.getFacetsSet(
      ).end(); ++jt)
00916             \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}[*jt].getSeparatedCells().insert(it->first);
00917 \}
00918 
\hypertarget{Mesh3D_8cpp_source.tex_l00919}{}\hyperlink{classFVCode3D_1_1Mesh3D_a32920906ccad9ef0572ebc4009214c86}{00919} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_a32920906ccad9ef0572ebc4009214c86}{Mesh3D::updateCellsWithNeighbors}()
00920 \{
00921     \textcolor{keywordflow}{for}(std::map<UInt,Facet3D>::iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.end(); ++it)
00922     \{
00923         \textcolor{keywordflow}{for}(std::set<UInt>::iterator jt = it->second.getSeparatedCells().begin(); jt != it->second.
      getSeparatedCells().end(); ++jt)
00924         \{
00925             \textcolor{keywordflow}{for}(std::set<UInt>::reverse\_iterator kt = it->second.getSeparatedCells().rbegin(); kt.base() !=
       jt; ++kt)
00926             \{
00927                 \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}[*jt].getNeighborsSet().insert(*kt);
00928                 \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}[*kt].getNeighborsSet().insert(*jt);
00929             \}
00930         \}
00931     \}
00932 \}
00933 
\hypertarget{Mesh3D_8cpp_source.tex_l00934}{}\hyperlink{classFVCode3D_1_1Mesh3D_a609f980329f5a98e9fad724049e509d2}{00934} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_a609f980329f5a98e9fad724049e509d2}{Mesh3D::buildNodesToFacetMap}()
00935 \{
00936     std::map<UInt,Facet3D>::const\_iterator itF;
00937     std::vector<UInt> nodes;
00938 
00939     \textcolor{keywordflow}{for}(itF = \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.begin(); itF != \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.end(); ++itF)
00940     \{
00941         nodes = itF->second.getVerticesVector();
00942         sort(nodes.begin(), nodes.end());
00943         \hyperlink{classFVCode3D_1_1Mesh3D_add5bb503fb6d9bf6ee0656f02e712b06}{M\_nodesToFacet}.insert( std::pair<std::vector<UInt>, \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt}>(nodes, itF->first) );
00944     \}
00945 \}
00946 
\hypertarget{Mesh3D_8cpp_source.tex_l00947}{}\hyperlink{classFVCode3D_1_1Mesh3D_a2ac0b84c13a15ed42cdd8c98066eae98}{00947} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} \hyperlink{classFVCode3D_1_1Mesh3D_a2ac0b84c13a15ed42cdd8c98066eae98}{Mesh3D::getFacetFromNodes}(std::vector<UInt> & nodes) \textcolor{keywordflow}{throw}()
00948 \{
00949     \textcolor{keywordtype}{bool} found = \textcolor{keyword}{true};
00950     \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} idFacet = 0;
00951 
00952     \textcolor{keywordflow}{if}(\hyperlink{classFVCode3D_1_1Mesh3D_add5bb503fb6d9bf6ee0656f02e712b06}{M\_nodesToFacet}.empty())
00953     \{
00954         std::set<UInt> nodesIds(nodes.begin(), nodes.end());
00955         std::set<UInt> facetsIds;
00956         std::map<UInt,Facet3D>::const\_iterator itF;
00957         std::set<UInt>::const\_iterator it, it2;
00958 
00959         \textcolor{keywordflow}{for}(itF = \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.begin(); itF != \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.end(); ++itF)
00960         \{
00961             found = \textcolor{keyword}{true};
00962             idFacet = itF->first;
00963             facetsIds.clear();
00964             facetsIds.insert(itF->second.getVerticesVector().begin(), itF->second.getVerticesVector().end()
      );
00965             \textcolor{keywordflow}{for}(it = facetsIds.begin(), it2 = nodesIds.begin(); it != facetsIds.end(); ++it, ++it2)
00966             \{
00967                 \textcolor{keywordflow}{if}( *it != *it2 )
00968                 \{
00969                     found = \textcolor{keyword}{false};
00970                     \textcolor{keywordflow}{break};
00971                 \}
00972             \}
00973             \textcolor{keywordflow}{if}(found)
00974                 \textcolor{keywordflow}{break};
00975         \}
00976     \}
00977     \textcolor{keywordflow}{else}
00978     \{
00979         std::map<std::vector<UInt>, \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt}>::const\_iterator itM;
00980         sort(nodes.begin(), nodes.end());
00981         itM = \hyperlink{classFVCode3D_1_1Mesh3D_add5bb503fb6d9bf6ee0656f02e712b06}{M\_nodesToFacet}.find(nodes);
00982         \textcolor{keywordflow}{if}(itM == \hyperlink{classFVCode3D_1_1Mesh3D_add5bb503fb6d9bf6ee0656f02e712b06}{M\_nodesToFacet}.end())
00983             found = \textcolor{keyword}{false};
00984         \textcolor{keywordflow}{else}
00985             idFacet = itM->second;
00986     \}
00987 
00988     \textcolor{keywordflow}{if}(!found)
00989     \{
00990         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"Error: facet not found in "} + std::string(\_\_FUNCTION\_\_) + \textcolor{stringliteral}{"."} );
00991     \}
00992 
00993     \textcolor{keywordflow}{return} idFacet;
00994 \}
00995 
\hypertarget{Mesh3D_8cpp_source.tex_l00996}{}\hyperlink{classFVCode3D_1_1Mesh3D_a9c8350dc981d42ba80f37625cf978d3c}{00996} \textcolor{keywordtype}{bool} \hyperlink{classFVCode3D_1_1Mesh3D_a9c8350dc981d42ba80f37625cf978d3c}{Mesh3D::exportVTU}(\textcolor{keyword}{const} std::string & filename) \textcolor{keyword}{const} \textcolor{keywordflow}{throw}()
00997 \{
00998     std::fstream filestr;
00999 
01000     filestr.open (filename.c\_str(), std::ios\_base::out);
01001 
01002     \textcolor{keywordflow}{if} (filestr.is\_open())
01003     \{
01004         std::cout << std::endl << \textcolor{stringliteral}{" File: "} << filename << \textcolor{stringliteral}{", successfully opened"};
01005     \}
01006     \textcolor{keywordflow}{else}
01007     \{
01008         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"Error: file "} + filename + \textcolor{stringliteral}{" not opened."});
01009     \}
01010 
01011     std::cout << std::endl << \textcolor{stringliteral}{" Exporting Mesh3D in Vtu format... "} << std::endl;
01012 
01013     \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nPoints = \hyperlink{classFVCode3D_1_1Mesh3D_a5464981fd097ce785675d91522884739}{M\_nodes}.size();
01014     \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nCells = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.size();
01015     \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nVal = 0, offsets = 0, faceOffsets = 0;
01016 
01017     \textcolor{keywordflow}{for}( std::map<UInt,Cell3D>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.end(); ++it )
01018         nVal += it->second.verticesNumber() + 1;
01019 
01020     \textcolor{comment}{// Header}
01021     filestr << \textcolor{stringliteral}{"<?xml version=\(\backslash\)"1.0\(\backslash\)"?>"} << std::endl;
01022     filestr << \textcolor{stringliteral}{"<VTKFile type=\(\backslash\)"UnstructuredGrid\(\backslash\)" version=\(\backslash\)"0.1\(\backslash\)" byte\_order=\(\backslash\)"LittleEndian\(\backslash\)" compressor=
      \(\backslash\)"vtkZLibDataCompressor\(\backslash\)">"} << std::endl;
01023     filestr << \textcolor{stringliteral}{"\(\backslash\)t<UnstructuredGrid>"} << std::endl;
01024     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t<Piece NumberOfPoints=\(\backslash\)""} << nPoints << \textcolor{stringliteral}{"\(\backslash\)" NumberOfCells=\(\backslash\)""} << nCells << \textcolor{stringliteral}{"\(\backslash\)">"} << 
      std::endl;
01025 
01026     \textcolor{comment}{// CellData}
01027     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t<CellData Scalars=\(\backslash\)"cellID\(\backslash\)">"} << std::endl;
01028     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)"Int64\(\backslash\)" Name=\(\backslash\)"cellID\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01029     filestr << std::scientific << std::setprecision(0);
01030     \textcolor{keywordflow}{for}( std::map<UInt,Cell3D>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.end(); ++it )
01031         filestr << it->first << std::endl;
01032     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01033     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t</CellData>"} << std::endl;
01034 
01035     filestr << std::scientific << std::setprecision(16);
01036 
01037     \textcolor{comment}{// Points}
01038     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t<Points>"} << std::endl;
01039     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)""} << \textcolor{stringliteral}{"Float64"} << \textcolor{stringliteral}{"\(\backslash\)" Name=\(\backslash\)"Points\(\backslash\)" NumberOfComponents=\(\backslash\)"3\(\backslash\)"
       format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01040     \textcolor{keywordflow}{for}( std::vector<Point3D>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_a5464981fd097ce785675d91522884739}{M\_nodes}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_a5464981fd097ce785675d91522884739}{M\_nodes}.end(); ++it )
01041         filestr << it->x() << \textcolor{stringliteral}{" "} << it->y() << \textcolor{stringliteral}{" "} << it->z() <<std::endl;
01042     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01043     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t</Points>"} << std::endl;
01044 
01045     \textcolor{comment}{// Cells}
01046     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t<Cells>"} << std::endl;
01047     \textcolor{comment}{//  Connectivity}
01048     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)"Int64\(\backslash\)" Name=\(\backslash\)"connectivity\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01049     \textcolor{keywordflow}{for}( std::map<UInt,Cell3D>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.end(); ++it )
01050     \{
01051         \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator jt = it->second.getVerticesVector().begin(); jt != it->
      second.getVerticesVector().end()-1; ++jt )
01052             filestr << *jt << \textcolor{stringliteral}{" "};
01053         filestr << *(it->second.getVerticesVector().rbegin()) << std::endl;
01054     \}
01055     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01056 
01057     \textcolor{comment}{//  Offsets}
01058     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)"Int64\(\backslash\)" Name=\(\backslash\)"offsets\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01059     \textcolor{keywordflow}{for}( std::map<UInt,Cell3D>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.end(); ++it )
01060     \{
01061         offsets += it->second.verticesNumber();
01062         filestr << offsets << std::endl;
01063     \}
01064     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01065 
01066     \textcolor{comment}{//  Types}
01067     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)"UInt8\(\backslash\)" Name=\(\backslash\)"types\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01068     \textcolor{keywordflow}{for}( \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} i=0; i < nCells ; ++i )
01069         filestr << \textcolor{stringliteral}{"42"} << std::endl;
01070     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01071 
01072     \textcolor{comment}{//  Faces}
01073     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)"Int64\(\backslash\)" Name=\(\backslash\)"faces\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01074     \textcolor{keywordflow}{for}( std::map<UInt,Cell3D>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.end(); ++it )
01075     \{
01076         filestr << it->second.facetsNumber() << std::endl;
01077         \textcolor{keywordflow}{for}( std::set<UInt>::const\_iterator jt = it->second.getFacetsSet().begin(); jt != it->second.
      getFacetsSet().end(); ++jt )
01078         \{
01079             filestr << \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.at(*jt).getNumberOfVertices() << std::endl;
01080             \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator kt = \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.at(*jt).getVerticesVector().begin(
      ); kt != \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.at(*jt).getVerticesVector().end()-1; ++kt )
01081                 filestr << *kt << \textcolor{stringliteral}{" "};
01082             filestr << *(\hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.at(*jt).getVerticesVector().rbegin()) << std::endl;
01083         \}
01084     \}
01085     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01086 
01087     \textcolor{comment}{//  Faceoffsets}
01088     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)"Int64\(\backslash\)" Name=\(\backslash\)"faceoffsets\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01089     \textcolor{keywordflow}{for}( std::map<UInt,Cell3D>::const\_iterator it = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.begin(); it != 
      \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.end(); ++it )
01090     \{
01091         faceOffsets += 1 + it->second.facetsNumber();
01092         \textcolor{keywordflow}{for}( std::set<UInt>::const\_iterator jt = it->second.getFacetsSet().begin(); jt != it->second.
      getFacetsSet().end(); ++jt )
01093             faceOffsets += \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.at(*jt).getNumberOfVertices();
01094         filestr << faceOffsets << std::endl;
01095     \}
01096     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01097     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t</Cells>"} << std::endl;
01098 
01099     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t</Piece>"} << std::endl;
01100     filestr << \textcolor{stringliteral}{"\(\backslash\)t</UnstructuredGrid>"} << std::endl;
01101     filestr << \textcolor{stringliteral}{"\(\backslash\)t</VTKFile>"} << std::endl;
01102 
01103     filestr.close();
01104 
01105     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
01106 \}
01107 
\hypertarget{Mesh3D_8cpp_source.tex_l01108}{}\hyperlink{classFVCode3D_1_1Mesh3D_a77553756736b340eb9de044471b73150}{01108} \textcolor{keywordtype}{bool} \hyperlink{classFVCode3D_1_1Mesh3D_a77553756736b340eb9de044471b73150}{Mesh3D::exportCellsVTU}(\textcolor{keyword}{const} std::string & filename, \textcolor{keyword}{const} std::vector<UInt> & 
      idCells) \textcolor{keyword}{const} \textcolor{keywordflow}{throw}()
01109 \{
01110     std::fstream filestr;
01111 
01112     filestr.open (filename.c\_str(), std::ios\_base::out);
01113 
01114     \textcolor{keywordflow}{if} (filestr.is\_open())
01115     \{
01116         std::cout << std::endl << \textcolor{stringliteral}{" File: "} << filename << \textcolor{stringliteral}{", successfully opened"};
01117     \}
01118     \textcolor{keywordflow}{else}
01119     \{
01120         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"Error: file "} + filename + \textcolor{stringliteral}{" not opened."});
01121     \}
01122 
01123     std::cout << std::endl << \textcolor{stringliteral}{" Exporting Mesh3D in Vtu format... "} << std::endl;
01124 
01125     \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nPoints = 0;
01126     \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nCells = idCells.size();
01127     \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} offsets = 0, faceOffsets = 0;
01128 
01129     \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator it = idCells.begin(); it != idCells.end(); ++it )
01130         nPoints += \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).verticesNumber();
01131 
01132     \textcolor{comment}{// Header}
01133     filestr << \textcolor{stringliteral}{"<?xml version=\(\backslash\)"1.0\(\backslash\)"?>"} << std::endl;
01134     filestr << \textcolor{stringliteral}{"<VTKFile type=\(\backslash\)"UnstructuredGrid\(\backslash\)" version=\(\backslash\)"0.1\(\backslash\)" byte\_order=\(\backslash\)"LittleEndian\(\backslash\)" compressor=
      \(\backslash\)"vtkZLibDataCompressor\(\backslash\)">"} << std::endl;
01135     filestr << \textcolor{stringliteral}{"\(\backslash\)t<UnstructuredGrid>"} << std::endl;
01136     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t<Piece NumberOfPoints=\(\backslash\)""} << nPoints << \textcolor{stringliteral}{"\(\backslash\)" NumberOfCells=\(\backslash\)""} << nCells << \textcolor{stringliteral}{"\(\backslash\)">"} << 
      std::endl;
01137 
01138     \textcolor{comment}{// CellData}
01139     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t<CellData Scalars=\(\backslash\)"cellID\(\backslash\)">"} << std::endl;
01140     filestr << \textcolor{stringliteral}{"<\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)tDataArray type=\(\backslash\)"Int64\(\backslash\)" Name=\(\backslash\)"cellID\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01141     filestr << std::scientific << std::setprecision(0);
01142     \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator it = idCells.begin(); it != idCells.end(); ++it )
01143         filestr << *it << std::endl;
01144     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01145     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t</CellData>"} << std::endl;
01146 
01147     filestr << std::scientific << std::setprecision(16);
01148 
01149     \textcolor{comment}{// Pointdata}
01150     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t<Points>"} << std::endl;
01151     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)""} << \textcolor{stringliteral}{"Float64"} << \textcolor{stringliteral}{"\(\backslash\)" Name=\(\backslash\)"Points\(\backslash\)" NumberOfComponents=\(\backslash\)"3\(\backslash\)"
       format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01152     \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator it = idCells.begin(); it != idCells.end(); ++it )
01153         \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator jt = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).getVerticesVector().begin(); jt 
      != \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).getVerticesVector().end(); ++jt)
01154             filestr << \hyperlink{classFVCode3D_1_1Mesh3D_a5464981fd097ce785675d91522884739}{M\_nodes}[*jt].x() << \textcolor{stringliteral}{" "} << \hyperlink{classFVCode3D_1_1Mesh3D_a5464981fd097ce785675d91522884739}{M\_nodes}[*jt].y() << \textcolor{stringliteral}{" "} << 
      \hyperlink{classFVCode3D_1_1Mesh3D_a5464981fd097ce785675d91522884739}{M\_nodes}[*jt].z() <<std::endl;
01155     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01156     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t</Points>"} << std::endl;
01157 
01158     \textcolor{comment}{// Cells}
01159     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t<Cells>"} << std::endl;
01160     \textcolor{comment}{//  Connectivity}
01161     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)"Int64\(\backslash\)" Name=\(\backslash\)"connectivity\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01162     \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator it = idCells.begin(); it != idCells.end(); ++it )
01163     \{
01164         \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator jt = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).getVerticesVector().begin(); jt 
      != \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).getVerticesVector().end()-1; ++jt )
01165             filestr << *jt << \textcolor{stringliteral}{" "};
01166         filestr << *(\hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).getVerticesVector().rbegin()) << std::endl;
01167     \}
01168     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01169 
01170     \textcolor{comment}{//  Offsets}
01171     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)"Int64\(\backslash\)" Name=\(\backslash\)"offsets\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01172     \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator it = idCells.begin(); it != idCells.end(); ++it )
01173     \{
01174         offsets += \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).verticesNumber();
01175         filestr << offsets << std::endl;
01176     \}
01177     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01178 
01179     \textcolor{comment}{//  Types}
01180     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)"UInt8\(\backslash\)" Name=\(\backslash\)"types\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01181     \textcolor{keywordflow}{for}( \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} i=0; i < nCells ; ++i )
01182         filestr << \textcolor{stringliteral}{"42"} << std::endl;
01183     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01184 
01185     \textcolor{comment}{//  Faces}
01186     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)"Int64\(\backslash\)" Name=\(\backslash\)"faces\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01187     \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator it = idCells.begin(); it != idCells.end(); ++it )
01188     \{
01189         filestr << \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).facetsNumber() << std::endl;
01190         \textcolor{keywordflow}{for}( std::set<UInt>::const\_iterator jt = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).getFacetsSet().begin(); jt != 
      \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).getFacetsSet().end(); ++jt )
01191         \{
01192             filestr << \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.at(*jt).getNumberOfVertices() << std::endl;
01193             \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator kt = \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.at(*jt).getVerticesVector().begin(
      ); kt != \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.at(*jt).getVerticesVector().end()-1; ++kt )
01194                 filestr << *kt << \textcolor{stringliteral}{" "};
01195             filestr << *(\hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.at(*jt).getVerticesVector().rbegin()) << std::endl;
01196         \}
01197     \}
01198     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01199 
01200     \textcolor{comment}{//  Faceoffsets}
01201     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t<DataArray type=\(\backslash\)"Int64\(\backslash\)" Name=\(\backslash\)"faceoffsets\(\backslash\)" format=\(\backslash\)"ascii\(\backslash\)">"} << std::endl;
01202     \textcolor{keywordflow}{for}( std::vector<UInt>::const\_iterator it = idCells.begin(); it != idCells.end(); ++it )
01203     \{
01204         faceOffsets += 1 + \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).facetsNumber();
01205         \textcolor{keywordflow}{for}( std::set<UInt>::const\_iterator jt = \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).getFacetsSet().begin(); jt != 
      \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.at(*it).getFacetsSet().end(); ++jt )
01206             faceOffsets += \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.at(*jt).getNumberOfVertices();
01207         filestr << faceOffsets << std::endl;
01208     \}
01209     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t\(\backslash\)t</DataArray>"} << std::endl;
01210     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t\(\backslash\)t</Cells>"} << std::endl;
01211 
01212     filestr << \textcolor{stringliteral}{"\(\backslash\)t\(\backslash\)t</Piece>"} << std::endl;
01213     filestr << \textcolor{stringliteral}{"\(\backslash\)t</UnstructuredGrid>"} << std::endl;
01214     filestr << \textcolor{stringliteral}{"\(\backslash\)t</VTKFile>"} << std::endl;
01215 
01216     filestr.close();
01217 
01218     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
01219 \}
01220 
\hypertarget{Mesh3D_8cpp_source.tex_l01221}{}\hyperlink{classFVCode3D_1_1Mesh3D_a98c0a7dd95e33c21e813f9402d71da15}{01221} \textcolor{keywordtype}{bool} \hyperlink{classFVCode3D_1_1Mesh3D_a98c0a7dd95e33c21e813f9402d71da15}{Mesh3D::exportFractureNetworkVTK}(\textcolor{keyword}{const} std::string & filename) \textcolor{keyword}{const} \textcolor{keywordflow}{
      throw}()
01222 \{
01223     \textcolor{keywordflow}{return} \hyperlink{classFVCode3D_1_1Mesh3D_ab197671318545b2b026899d435e79ddd}{M\_fn}.\hyperlink{classFVCode3D_1_1FractureNetwork3D_ab4a7dea9b15402cb2c82cf501c7e2356}{exportNetworkVTK}(filename);
01224 \}
01225 
\hypertarget{Mesh3D_8cpp_source.tex_l01226}{}\hyperlink{classFVCode3D_1_1Mesh3D_a076fb54969f3922a67bf26e7bf0fd8be}{01226} \textcolor{keywordtype}{bool} \hyperlink{classFVCode3D_1_1Mesh3D_a076fb54969f3922a67bf26e7bf0fd8be}{Mesh3D::exportFractureVTK}( \textcolor{keyword}{const} std::string & filename, \textcolor{keyword}{const} 
      \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} & f) \textcolor{keyword}{const} \textcolor{keywordflow}{throw}()
01227 \{
01228     \textcolor{keywordflow}{return} \hyperlink{classFVCode3D_1_1Mesh3D_ab197671318545b2b026899d435e79ddd}{M\_fn}.\hyperlink{classFVCode3D_1_1FractureNetwork3D_aef2f83259eaeb30eb24c6fdb3f3c0753}{getFracture}(f).\hyperlink{classFVCode3D_1_1Fracture3D_a1043c8fc93b79a1cea8d67d8adb2a418}{exportVTK}(filename);
01229 \}
01230 
\hypertarget{Mesh3D_8cpp_source.tex_l01231}{}\hyperlink{classFVCode3D_1_1Mesh3D_a1789482a87137f0c47a2dd9a1e302d66}{01231} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1Mesh3D_a1789482a87137f0c47a2dd9a1e302d66}{Mesh3D::clear}()
01232 \{
01233     \hyperlink{classFVCode3D_1_1Mesh3D_ab197671318545b2b026899d435e79ddd}{M\_fn}.\hyperlink{classFVCode3D_1_1FractureNetwork3D_af5ff78671d5ba6eb6604faeb2563205e}{clear}();
01234     \hyperlink{classFVCode3D_1_1Mesh3D_a5464981fd097ce785675d91522884739}{M\_nodes}.clear();
01235     \hyperlink{classFVCode3D_1_1Mesh3D_a57d8b6af7f4385d749c2d83c235764de}{M\_facets}.clear();
01236     \hyperlink{classFVCode3D_1_1Mesh3D_a8cac877e809226fb96078183efb25a2f}{M\_cells}.clear();
01237     \hyperlink{classFVCode3D_1_1Mesh3D_add5bb503fb6d9bf6ee0656f02e712b06}{M\_nodesToFacet}.clear();
01238 \}
01239 
01240 \textcolor{comment}{// --------------------   Overloading operator< (for Facet3D)  --------------------}
01241 
\hypertarget{Mesh3D_8cpp_source.tex_l01242}{}\hyperlink{namespaceFVCode3D_a66dad0ddea6ea9e534d2c3f3bb5d9958}{01242} \textcolor{keywordtype}{bool} \hyperlink{namespaceFVCode3D_a4d68dd4dc8a2720cd431013bc580e9d6}{operator<}(\textcolor{keyword}{const} \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D}{Mesh3D::Facet3D} & f1, \textcolor{keyword}{const} 
      \hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D}{Mesh3D::Facet3D} & f2)
01243 \{
01244     std::vector<UInt> idF1, idF2;
01245     \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} sizeF1, sizeF2, minSize;
01246 
01247     idF1 = f1.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_aca13a319eb625d203f605634a6131657}{getVerticesVector}();
01248     std::sort(idF1.begin(), idF1.end());
01249     idF2 = f2.\hyperlink{classFVCode3D_1_1Mesh3D_1_1Facet3D_aca13a319eb625d203f605634a6131657}{getVerticesVector}();
01250     std::sort(idF2.begin(), idF2.end());
01251     sizeF1 = idF1.size();
01252     sizeF2 = idF2.size();
01253     minSize = std::min(sizeF1,sizeF2);
01254     \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} i=0; i<minSize; ++i)
01255     \{
01256         \textcolor{keywordflow}{if}(idF1[i] < idF2[i])
01257             \textcolor{keywordflow}{return} \textcolor{keyword}{true};
01258         \textcolor{keywordflow}{if}(idF1[i] > idF2[i])
01259             \textcolor{keywordflow}{return} \textcolor{keyword}{false};
01260     \}
01261 
01262     \textcolor{keywordflow}{return} sizeF1<sizeF2;
01263 \}
01264 
01265 \} \textcolor{comment}{// namespace FVCode3D}
\end{DoxyCode}
