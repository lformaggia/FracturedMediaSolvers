\hypertarget{TetGenWrapper_8cpp_source}{}\section{Tet\+Gen\+Wrapper.\+cpp}
\label{TetGenWrapper_8cpp_source}\index{/home/corinne/eni\+Reservoir\+G\+I\+T\+H\+U\+B/eni\+Reservoir/\+F\+V\+Code3\+D/src/\+F\+V\+Code3\+D/mesh/\+Tet\+Gen\+Wrapper.\+cpp@{/home/corinne/eni\+Reservoir\+G\+I\+T\+H\+U\+B/eni\+Reservoir/\+F\+V\+Code3\+D/src/\+F\+V\+Code3\+D/mesh/\+Tet\+Gen\+Wrapper.\+cpp}}

\begin{DoxyCode}
00001 
00006 \textcolor{preprocessor}{#include <\hyperlink{tetgen_8h}{FVCode3D/tetgen.h}>}
00007 \textcolor{preprocessor}{#include <\hyperlink{Operations_8hpp}{FVCode3D/geometry/Operations.hpp}>}
00008 \textcolor{preprocessor}{#include <\hyperlink{TetGenWrapper_8hpp}{FVCode3D/mesh/TetGenWrapper.hpp}>}
00009 
00010 \textcolor{keyword}{namespace }\hyperlink{namespaceFVCode3D}{FVCode3D}
00011 \{
00012 
\hypertarget{TetGenWrapper_8cpp_source.tex_l00013}{}\hyperlink{classFVCode3D_1_1TetGenWrapper_adf67f9b1994b718a65f36724d42e65b0}{00013} \hyperlink{classFVCode3D_1_1TetGenWrapper_ac89da37a0ce92c84ab8c74829031192e}{TetGenWrapper::TetGenWrapper}(std::vector<Point3D> nodes, std::vector< 
      std::vector<UInt> > faces):
00014     M\_inNodes(nodes), M\_faces(faces), M\_volume(0.) \{\}
00015 
\hypertarget{TetGenWrapper_8cpp_source.tex_l00016}{}\hyperlink{classFVCode3D_1_1TetGenWrapper_ad2965002885016bd26494629af54ce97}{00016} \textcolor{keywordtype}{void} \hyperlink{classFVCode3D_1_1TetGenWrapper_ad2965002885016bd26494629af54ce97}{TetGenWrapper::generateMesh}()
00017 \{
00018     \hyperlink{classtetgenio}{tetgenio} in, out;
00019     \hyperlink{structtetgenio_1_1facet}{tetgenio::facet} *f;
00020     \hyperlink{structtetgenio_1_1polygon}{tetgenio::polygon} *p;
00021     \hyperlink{classFVCode3D_1_1Point3D}{Point3D} tmp;
00022 
00023     \textcolor{comment}{// All indices start from 1.}
00024     in.\hyperlink{classtetgenio_ace3ae3f90741f8e51e02f5007d81e440}{firstnumber} = 0;
00025 
00026     \textcolor{comment}{// Set nodes}
00027     in.\hyperlink{classtetgenio_a5211bec795ba870c01fadade4cd8670f}{numberofpoints} = \hyperlink{classFVCode3D_1_1TetGenWrapper_ae0637911dffc55fc74b5414fc6e8e417}{M\_inNodes}.size();
00028     in.\hyperlink{classtetgenio_a69b1e0f645f57281d838569c2bbc5789}{pointlist} = \textcolor{keyword}{new} \hyperlink{tetgen_8h_a4b654506f18b8bfd61ad2a29a7e38c25}{REAL}[in.\hyperlink{classtetgenio_a5211bec795ba870c01fadade4cd8670f}{numberofpoints} * 3];
00029 
00030     \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a2263c42382b217732a2d4e1f7348120a}{Int} i=0; i<in.\hyperlink{classtetgenio_a5211bec795ba870c01fadade4cd8670f}{numberofpoints}; ++i)
00031     \{
00032         in.\hyperlink{classtetgenio_a69b1e0f645f57281d838569c2bbc5789}{pointlist}[3*i]   = \hyperlink{classFVCode3D_1_1TetGenWrapper_ae0637911dffc55fc74b5414fc6e8e417}{M\_inNodes}[i].x();
00033         in.\hyperlink{classtetgenio_a69b1e0f645f57281d838569c2bbc5789}{pointlist}[3*i+1] = \hyperlink{classFVCode3D_1_1TetGenWrapper_ae0637911dffc55fc74b5414fc6e8e417}{M\_inNodes}[i].y();
00034         in.\hyperlink{classtetgenio_a69b1e0f645f57281d838569c2bbc5789}{pointlist}[3*i+2] = \hyperlink{classFVCode3D_1_1TetGenWrapper_ae0637911dffc55fc74b5414fc6e8e417}{M\_inNodes}[i].z();
00035     \}
00036 
00037     \textcolor{comment}{// Set facets}
00038     in.\hyperlink{classtetgenio_af1cb1515751c9cd0497abba62da8790d}{numberoffacets} = \hyperlink{classFVCode3D_1_1TetGenWrapper_ae883359645d72961078fe02a886df3be}{M\_faces}.size();
00039     in.\hyperlink{classtetgenio_ad65489b9aece6ba14ff8e3c89f533ced}{facetlist} = \textcolor{keyword}{new} \hyperlink{structtetgenio_1_1facet}{tetgenio::facet}[in.\hyperlink{classtetgenio_af1cb1515751c9cd0497abba62da8790d}{numberoffacets}];
00040     in.\hyperlink{classtetgenio_a0d5d9d0718980f8e9d4ecc3e771abba0}{facetmarkerlist} = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[in.\hyperlink{classtetgenio_af1cb1515751c9cd0497abba62da8790d}{numberoffacets}];
00041 
00042     \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a2263c42382b217732a2d4e1f7348120a}{Int} i=0; i<in.\hyperlink{classtetgenio_af1cb1515751c9cd0497abba62da8790d}{numberoffacets}; ++i)
00043     \{
00044         f = &in.\hyperlink{classtetgenio_ad65489b9aece6ba14ff8e3c89f533ced}{facetlist}[i];
00045         f->\hyperlink{structtetgenio_1_1facet_a845d93a1341532b2f0de8b1e75a5d0bb}{numberofpolygons} = 1;
00046         f->\hyperlink{structtetgenio_1_1facet_ad73474fc4f07efdd714f0441948c5dfa}{polygonlist} = \textcolor{keyword}{new} \hyperlink{structtetgenio_1_1polygon}{tetgenio::polygon}[f->
      \hyperlink{structtetgenio_1_1facet_a845d93a1341532b2f0de8b1e75a5d0bb}{numberofpolygons}];
00047         f->\hyperlink{structtetgenio_1_1facet_acc9857df4007aa20199f8979353339c7}{numberofholes} = 0;
00048         f->\hyperlink{structtetgenio_1_1facet_aecc34fbcd7087b45baecf2ba43d57757}{holelist} = NULL;
00049         p = &f->\hyperlink{structtetgenio_1_1facet_ad73474fc4f07efdd714f0441948c5dfa}{polygonlist}[0];
00050         p->\hyperlink{structtetgenio_1_1polygon_a019f9c62f145cf7d85227f401fcdba38}{numberofvertices} = \hyperlink{classFVCode3D_1_1TetGenWrapper_ae883359645d72961078fe02a886df3be}{M\_faces}[i].size();
00051         p->\hyperlink{structtetgenio_1_1polygon_a3cc2d3756bc093db5c252dd8f42a5001}{vertexlist} = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[p->\hyperlink{structtetgenio_1_1polygon_a019f9c62f145cf7d85227f401fcdba38}{numberofvertices}];
00052         \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a2263c42382b217732a2d4e1f7348120a}{Int} j=0; j<p->\hyperlink{structtetgenio_1_1polygon_a019f9c62f145cf7d85227f401fcdba38}{numberofvertices}; ++j)
00053         \{
00054             p->\hyperlink{structtetgenio_1_1polygon_a3cc2d3756bc093db5c252dd8f42a5001}{vertexlist}[j] = \hyperlink{classFVCode3D_1_1TetGenWrapper_ae883359645d72961078fe02a886df3be}{M\_faces}[i][j];
00055         \}
00056     \}
00057 
00058     \textcolor{comment}{// Set 'in.facetmarkerlist'}
00059     \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a2263c42382b217732a2d4e1f7348120a}{Int} i=0; i<in.\hyperlink{classtetgenio_af1cb1515751c9cd0497abba62da8790d}{numberoffacets}; ++i)
00060         in.\hyperlink{classtetgenio_a0d5d9d0718980f8e9d4ecc3e771abba0}{facetmarkerlist}[i] = 0;
00061 
00062     \textcolor{keywordtype}{char} option[] = \textcolor{stringliteral}{"pYQ"};
00063     \hyperlink{tetgen_8h_ad3637eb4ffe7fda90667e67b7771d964}{tetrahedralize}(option, &in, &out);
00064 
00065     \textcolor{comment}{// Get the output nodes}
00066     \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}.resize(out.\hyperlink{classtetgenio_a5211bec795ba870c01fadade4cd8670f}{numberofpoints});
00067     \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a2263c42382b217732a2d4e1f7348120a}{Int} i=0; i<out.\hyperlink{classtetgenio_a5211bec795ba870c01fadade4cd8670f}{numberofpoints}; ++i)
00068     \{
00069         tmp.\hyperlink{classFVCode3D_1_1Point3D_af250a1c49cf1aeeb52f59a687257451d}{setValues}(out.\hyperlink{classtetgenio_a69b1e0f645f57281d838569c2bbc5789}{pointlist}[3*i], out.\hyperlink{classtetgenio_a69b1e0f645f57281d838569c2bbc5789}{pointlist}[3*i+1], out.
      \hyperlink{classtetgenio_a69b1e0f645f57281d838569c2bbc5789}{pointlist}[3*i+2]);
00070         \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[i] = tmp;
00071     \}
00072 
00073     \textcolor{comment}{// Get the output elements}
00074     \hyperlink{classFVCode3D_1_1TetGenWrapper_a016da330a68cb7cd44881dc26efed5b5}{M\_elements}.resize(out.\hyperlink{classtetgenio_ad9a3fc307214cd459ca367c55d4bc16d}{numberoftetrahedra});
00075     \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a2263c42382b217732a2d4e1f7348120a}{Int} i=0; i<out.\hyperlink{classtetgenio_ad9a3fc307214cd459ca367c55d4bc16d}{numberoftetrahedra}; ++i)
00076     \{
00077         \hyperlink{classFVCode3D_1_1TetGenWrapper_a016da330a68cb7cd44881dc26efed5b5}{M\_elements}[i].resize(4);
00078         \hyperlink{classFVCode3D_1_1TetGenWrapper_a016da330a68cb7cd44881dc26efed5b5}{M\_elements}[i][0] = out.\hyperlink{classtetgenio_ae53a07184487b2635d0f332ff818d938}{tetrahedronlist}[4*i];
00079         \hyperlink{classFVCode3D_1_1TetGenWrapper_a016da330a68cb7cd44881dc26efed5b5}{M\_elements}[i][1] = out.\hyperlink{classtetgenio_ae53a07184487b2635d0f332ff818d938}{tetrahedronlist}[4*i+1];
00080         \hyperlink{classFVCode3D_1_1TetGenWrapper_a016da330a68cb7cd44881dc26efed5b5}{M\_elements}[i][2] = out.\hyperlink{classtetgenio_ae53a07184487b2635d0f332ff818d938}{tetrahedronlist}[4*i+2];
00081         \hyperlink{classFVCode3D_1_1TetGenWrapper_a016da330a68cb7cd44881dc26efed5b5}{M\_elements}[i][3] = out.\hyperlink{classtetgenio_ae53a07184487b2635d0f332ff818d938}{tetrahedronlist}[4*i+3];
00082     \}
00083 \} \textcolor{comment}{// TetGenWrapper::generateMesh}
00084 
\hypertarget{TetGenWrapper_8cpp_source.tex_l00085}{}\hyperlink{classFVCode3D_1_1TetGenWrapper_a519cb27415baac338386403c46af7b08}{00085} \hyperlink{namespaceFVCode3D_a40c1f5588a248569d80aa5f867080e83}{Real} \hyperlink{classFVCode3D_1_1TetGenWrapper_a519cb27415baac338386403c46af7b08}{TetGenWrapper::computeVolume}()
00086 \{
00087     \hyperlink{classFVCode3D_1_1TetGenWrapper_a820391e6d290e49db68b107fd5ab0e75}{M\_volume} = 0.;
00088     \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nEle = \hyperlink{classFVCode3D_1_1TetGenWrapper_a016da330a68cb7cd44881dc26efed5b5}{M\_elements}.size();
00089     std::vector<Point3D> tmp(4);
00090 
00091     \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} i=0; i<nEle; ++i)
00092     \{
00093         tmp[0] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[\hyperlink{classFVCode3D_1_1TetGenWrapper_a016da330a68cb7cd44881dc26efed5b5}{M\_elements}[i][0]];
00094         tmp[1] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[M\_elements[i][1]];
00095         tmp[2] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[M\_elements[i][2]];
00096         tmp[3] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[M\_elements[i][3]];
00097         \hyperlink{classFVCode3D_1_1TetGenWrapper_a820391e6d290e49db68b107fd5ab0e75}{M\_volume} += \hyperlink{namespaceFVCode3D_a8a6b07162e2801b628c3bd4057b9f221}{tetrahedronVolume}(tmp);
00098     \}
00099 
00100     \textcolor{keywordflow}{return} \hyperlink{classFVCode3D_1_1TetGenWrapper_a820391e6d290e49db68b107fd5ab0e75}{M\_volume};
00101 \} \textcolor{comment}{// TetGenWrapper::computeVolume}
00102 
\hypertarget{TetGenWrapper_8cpp_source.tex_l00103}{}\hyperlink{classFVCode3D_1_1TetGenWrapper_ad3574fde5de1292dc9064d717a3ee353}{00103} \hyperlink{classFVCode3D_1_1Point3D}{Point3D} \hyperlink{classFVCode3D_1_1TetGenWrapper_ad3574fde5de1292dc9064d717a3ee353}{TetGenWrapper::computeCenterOfMass}()
00104 \{
00105     \hyperlink{classFVCode3D_1_1TetGenWrapper_a4c2e389ea6cc0cec7c83b7e241976807}{M\_centerOfMass}.\hyperlink{classFVCode3D_1_1Point3D_af250a1c49cf1aeeb52f59a687257451d}{setValues}(0.,0.,0.);
00106     \textcolor{keyword}{const} \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} nEle = \hyperlink{classFVCode3D_1_1TetGenWrapper_a016da330a68cb7cd44881dc26efed5b5}{M\_elements}.size();
00107     std::vector<Point3D> tmp(4);
00108     \hyperlink{namespaceFVCode3D_a40c1f5588a248569d80aa5f867080e83}{Real} tmpVol, totVol = 0.;
00109 
00110     \textcolor{keywordflow}{for}(\hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} i=0; i<nEle; ++i)
00111     \{
00112         tmp[0] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[\hyperlink{classFVCode3D_1_1TetGenWrapper_a016da330a68cb7cd44881dc26efed5b5}{M\_elements}[i][0]];
00113         tmp[1] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[M\_elements[i][1]];
00114         tmp[2] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[M\_elements[i][2]];
00115         tmp[3] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[M\_elements[i][3]];
00116         tmpVol = \hyperlink{namespaceFVCode3D_a8a6b07162e2801b628c3bd4057b9f221}{tetrahedronVolume}(tmp);
00117         totVol += tmpVol;
00118         \hyperlink{classFVCode3D_1_1TetGenWrapper_a4c2e389ea6cc0cec7c83b7e241976807}{M\_centerOfMass} += tmpVol * (tmp[0] + tmp[1] + tmp[2] + tmp[3]) / 4.;
00119     \}
00120 
00121     \hyperlink{classFVCode3D_1_1TetGenWrapper_a4c2e389ea6cc0cec7c83b7e241976807}{M\_centerOfMass} /= totVol;
00122 
00123     \textcolor{keywordflow}{return} \hyperlink{classFVCode3D_1_1TetGenWrapper_a4c2e389ea6cc0cec7c83b7e241976807}{M\_centerOfMass};
00124 \} \textcolor{comment}{// TetGenWrapper::computeCenterOfMass}
00125 
\hypertarget{TetGenWrapper_8cpp_source.tex_l00126}{}\hyperlink{classFVCode3D_1_1TetGenWrapper_aa078ba35c38e79cae708b7fd632ceac4}{00126} \textcolor{keyword}{const} std::vector<Point3D> \hyperlink{classFVCode3D_1_1TetGenWrapper_aa078ba35c38e79cae708b7fd632ceac4}{TetGenWrapper::getElement}(\textcolor{keyword}{const} 
      \hyperlink{namespaceFVCode3D_a4bf7e328c75d0fd504050d040ebe9eda}{UInt} i)\textcolor{keyword}{ const}
00127 \textcolor{keyword}{}\{
00128     std::vector<Point3D> points(4);
00129 
00130     points[0] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[\hyperlink{classFVCode3D_1_1TetGenWrapper_a016da330a68cb7cd44881dc26efed5b5}{M\_elements}[i][0]];
00131     points[1] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[M\_elements[i][1]];
00132     points[2] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[M\_elements[i][2]];
00133     points[3] = \hyperlink{classFVCode3D_1_1TetGenWrapper_a04672b7a2b60730190e0e82af43ed38b}{M\_outNodes}[M\_elements[i][3]];
00134 
00135     \textcolor{keywordflow}{return} points;
00136 \} \textcolor{comment}{// TetGenWrapper::getElement}
00137 
00138 \}\textcolor{comment}{// namespace FVCode3D}
\end{DoxyCode}
